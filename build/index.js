(()=>{var e={744:e=>{"use strict";var t=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===n}(e)}(e)},n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?l((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function o(e,t,n){return e.concat(t).map((function(e){return r(e,n)}))}function i(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function a(e,t){try{return t in e}catch(e){return!1}}function l(e,n,s){(s=s||{}).arrayMerge=s.arrayMerge||o,s.isMergeableObject=s.isMergeableObject||t,s.cloneUnlessOtherwiseSpecified=r;var c=Array.isArray(n);return c===Array.isArray(e)?c?s.arrayMerge(e,n,s):function(e,t,n){var o={};return n.isMergeableObject(e)&&i(e).forEach((function(t){o[t]=r(e[t],n)})),i(t).forEach((function(i){(function(e,t){return a(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(a(e,i)&&n.isMergeableObject(t[i])?o[i]=function(e,t){if(!t.customMerge)return l;var n=t.customMerge(e);return"function"==typeof n?n:l}(i,n)(e[i],t[i],n):o[i]=r(t[i],n))})),o}(e,n,s):r(n,s)}l.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return l(e,n,t)}),{})};var s=l;e.exports=s},20:(e,t,n)=>{"use strict";var r=n(609),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!s.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:o,type:e,key:c,ref:u,props:i,_owner:l.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},848:(e,t,n)=>{"use strict";e.exports=n(20)},609:e=>{"use strict";e.exports=window.React},942:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=a(e,i(n)))}return e}function i(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return o.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=a(t,n));return t}function a(e,t){return t?e?e+" "+t:e+t:e}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};n.r(e),n.d(e,{closeModal:()=>at,disableComplementaryArea:()=>Qe,enableComplementaryArea:()=>Xe,openModal:()=>it,pinItem:()=>et,setDefaultComplementaryArea:()=>Ke,setFeatureDefaults:()=>ot,setFeatureValue:()=>rt,toggleFeature:()=>nt,unpinItem:()=>tt});var t={};n.r(t),n.d(t,{getActiveComplementaryArea:()=>lt,isComplementaryAreaLoading:()=>st,isFeatureActive:()=>ut,isItemPinned:()=>ct,isModalActive:()=>dt});var r={};n.r(r),n.d(r,{changePreviewDeviceType:()=>bo,closeSidebar:()=>ko,openSidebar:()=>So,requestSendingNewsletterPreview:()=>Co,revertAndSaveTemplate:()=>No,saveEditedEmail:()=>Po,setIsFetchingPersonalizationTags:()=>Io,setPersonalizationTagsList:()=>Do,setTemplateToPost:()=>To,toggleFeature:()=>yo,togglePersonalizationTagsModal:()=>jo,togglePreviewModal:()=>xo,toggleSettingsSidebarActiveTab:()=>Oo,updateEmailMailPoetProperty:()=>Eo,updateSendPreviewEmail:()=>wo});var o={};n.r(o),n.d(o,{getAutosaveInterval:()=>si,getCdnUrl:()=>ci,getCurrentTemplate:()=>Yo,getCurrentTemplateContent:()=>Jo,getDeviceType:()=>ai,getEditedEmailContent:()=>$o,getEditedPostTemplate:()=>Zo,getEmailPostId:()=>Qo,getEmailTemplates:()=>Xo,getGlobalEmailStylesPost:()=>Ko,getGlobalStylesPostId:()=>pi,getInitialEditorSettings:()=>ti,getPaletteColors:()=>ni,getPersonalizationTagsList:()=>ii,getPersonalizationTagsState:()=>oi,getPreviewState:()=>ri,getSentEmailEditorPosts:()=>qo,getSettingsSidebarActiveTab:()=>ei,getStyles:()=>li,getTheme:()=>di,getUrls:()=>mi,hasEdits:()=>Fo,hasEmptyContent:()=>Uo,isEmailLoaded:()=>Vo,isEmailSent:()=>Wo,isEmpty:()=>Go,isFeatureActive:()=>Ro,isPremiumPluginActive:()=>ui,isSaving:()=>Ho,isSidebarOpened:()=>zo});var i={};n.r(i),n.d(i,{getPersonalizationTagsList:()=>_i}),window.wp.formatLibrary;const a=window.wp.data,l=window.wp.element,s=window.wp.hooks,c=window.wp.blockLibrary;function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(e,t,n){return(t=function(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const f=window.wp.blockEditor,_=window.wp.compose;var h=n(848);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=(0,_.createHigherOrderComponent)((function(e){return function(t){return"core/columns"!==t.name?(0,h.jsx)(e,v({},t)):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(e,v({},t)),(0,h.jsx)(f.InspectorControls,{children:(0,h.jsx)("style",{children:"\n      .components-panel__body .components-toggle-control .components-form-toggle { opacity: 0.3; }\n      .components-panel__body .components-toggle-control .components-form-toggle__input { pointer-events: none; }\n      .components-panel__body .components-toggle-control label { pointer-events: none; }\n    "})})]})}}),"columnsEditCallback");const b=window.wp.i18n;function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e){var t=e.layoutClassNames,n=(0,f.useBlockProps)({className:t});return(0,h.jsxs)("div",j(j({},n),{},{children:[(0,h.jsx)("p",{children:(0,b.__)("This is the Content block.","mailpoet")}),(0,h.jsx)("p",{children:(0,b.__)("It will display all the blocks in the email content, which might be only simple text paragraphs. You can enrich your message with images, incorporate data through tables, explore different layout designs with columns, or use any other block type.","mailpoet")})]}))}function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=(0,_.createHigherOrderComponent)((function(e){return function(t){return"core/image"!==t.name?(0,h.jsx)(e,P({},t)):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(e,P({},t)),(0,h.jsx)(f.InspectorControls,{children:(0,h.jsx)("style",{children:"\n        .components-tools-panel .components-toggle-control { display: none; }\n      "})})]})}}),"imageEditCallback");function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function C(e,t){if(e){if("string"==typeof e)return T(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||C(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const I=window.wp.richText,D=window.wp.components;function M(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return A(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var _n=0,r=function(){};return{s:r,n:function(){return _n>=e.length?{done:!0}:{done:!1,value:e[_n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw o}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var B=function(e,t){var n=e.current.ownerDocument.defaultView.getSelection();if(!n.rangeCount)return{start:0,end:0};var r=n.getRangeAt(0);if(null===n.anchorNode.previousSibling)return{start:n.anchorOffset,end:n.anchorOffset+r.toString().length};var o=(0,I.create)({html:t}),i=n.anchorNode.previousSibling,a=function(e,t){var n,r=null,o=M(t.entries());try{for(o.s();!(n=o.n()).done;){var i=N(n.value,2),a=i[0],l=i[1];if(l){var s,c=M(l);try{for(c.s();!(s=c.n()).done;){var u,d=s.value;null!=d&&d.attributes&&e.tagName.toLowerCase()===(null===(u=d.tagName)||void 0===u?void 0:u.toLowerCase())&&e.getAttribute("data-link-href")===(null==d?void 0:d.attributes["data-link-href"])&&(r=a)}}catch(e){c.e(e)}finally{c.f()}}}}catch(e){o.e(e)}finally{o.f()}return r}(i=function(e){for(var t=e;t&&t.children.length>0;)t=t.children[0];return t}(i),o.formats);if(null!==a)return{start:a+n.anchorOffset+1,end:a+n.anchorOffset+r.toString().length};var l=function(e,t){var n,r=M(t.entries());try{for(r.s();!(n=r.n()).done;){var o=N(n.value,2),i=o[0],a=o[1];if(a){var l=a.attributes;if(e.getAttribute("data-rich-text-comment")===l["data-rich-text-comment"])return i}}}catch(e){r.e(e)}finally{r.f()}return null}(i,o.replacements);return null!==l?{start:l+n.anchorOffset+1,end:l+n.anchorOffset+r.toString().length}:{start:o.text.length,end:o.text.length+r.toString().length}},L=function(e,t){return t.forEach((function(t){if(e.includes(t.token.slice(0,t.token.length-1))){var n=t.token.substring(1,t.token.length-1).replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=new RegExp("(?<!\x3c!--)(?<![\"'])\\[(".concat(n,"(\\s[^\\]]*)?)\\](?!--\x3e)"),"g");e=e.replace(r,(function(e){return"\x3c!--".concat(e,"--\x3e")}))}})),e},R="email-editor/editor",z="document",F="block",V=function(e){var t=e.groupedTags,n=e.activeCategory,r=e.onCategorySelect,o=function(e){return e===n?"mailpoet-personalization-tags-modal__menu-item-active":""};return(0,h.jsxs)(D.MenuGroup,{className:"mailpoet-personalization-tags-modal__menu",children:[(0,h.jsx)(D.MenuItem,{onClick:function(){return r(null)},className:o(null),children:(0,b.__)("All")}),(0,h.jsx)("div",{className:"mailpoet-personalization-tags-modal__menu-separator","aria-hidden":"true"}),Object.keys(t).map((function(e,t,n){return(0,h.jsxs)(l.Fragment,{children:[(0,h.jsx)(D.MenuItem,{onClick:function(){return r(e)},className:o(e),children:e}),t<n.length-1&&(0,h.jsx)("div",{className:"mailpoet-personalization-tags-modal__menu-separator","aria-hidden":"true"})]},e)}))]})},H=function(e){var t=e.groupedTags,n=e.activeCategory,r=e.onInsert,o=e.canInsertLink,i=e.closeCallback,a=e.openLinkModal,l=null===n?Object.entries(t):[[n,t[n]||[]]];return(0,h.jsx)(h.Fragment,{children:l.map((function(e){var t=N(e,2),n=t[0],l=t[1];return(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{className:"mailpoet-personalization-tags-modal__category",children:n}),(0,h.jsx)("div",{className:"mailpoet-personalization-tags-modal__category-group",children:l.map((function(e){return(0,h.jsxs)("div",{className:"mailpoet-personalization-tags-modal__category-group-item",children:[(0,h.jsxs)("div",{className:"mailpoet-personalization-tags-modal__item-text",children:[(0,h.jsx)("strong",{children:e.name}),e.valueToInsert]}),(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[(0,h.jsx)(D.Button,{variant:"link",onClick:function(){r&&r(e.token,!1)},children:(0,b.__)("Insert")}),n===(0,b.__)("Link")&&o&&(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(D.Button,{variant:"link",onClick:function(){i(),a(e)},children:(0,b.__)("Insert as link")})})]})]},e.token)}))})]},n)}))})},G=function(e){var t=e.onInsert,n=e.isOpened,r=e.closeCallback,o=e.tag,i=N((0,l.useState)((0,b.__)("Link","mailpoet")),2),a=i[0],s=i[1];return n?(0,h.jsxs)(D.Modal,{size:"small",title:(0,b.__)("Insert Link","mailpoet"),onRequestClose:r,className:"mailpoet-personalization-tags-modal",children:[(0,h.jsx)(D.TextControl,{label:(0,b.__)("Link Text","mailpoet"),value:a,onChange:s}),(0,h.jsx)(D.Button,{isPrimary:!0,onClick:function(){t&&t(o.token,a)},children:(0,b.__)("Insert")})]}):null};const U=window.lodash;function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var $,q=(0,s.applyFilters)("mailpoet_email_editor_events_tracking_enabled",!1),Z="email_editor_events",Y=new EventTarget,J=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(q){var n="object"!==u(t)?{data:t}:t,r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:"".concat(Z,"_").concat(e)},n);Y.dispatchEvent(new CustomEvent(Z,{detail:r}))}},K=($={},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(q){var n="".concat(e,"_").concat(JSON.stringify(t).length);$[n]||(J(e,t),$[n]=!0)}}),X=(0,U.debounce)(J,700),Q=function(e){var t=e.onInsert,n=e.isOpened,r=e.closeCallback,o=e.canInsertLink,i=void 0!==o&&o,s=e.openedBy,c=void 0===s?"":s,u=N((0,l.useState)(null),2),d=u[0],p=u[1],m=N((0,l.useState)(""),2),f=m[0],_=m[1],g=N((0,l.useState)(null),2),v=g[0],y=g[1],x=N((0,l.useState)(!1),2),j=x[0],w=x[1],S=(0,a.useSelect)((function(e){return e(R).getPersonalizationTagsList()}),[]);if(j)return(0,h.jsx)(G,{onInsert:function(e,n){t(e,n),w(!1)},isOpened:j,closeCallback:function(){return w(!1)},tag:v});if(!n)return null;K("personalization_tags_modal_opened",{openedBy:c});var k=S.reduce((function(e,t){var n=t.category,r=t.name,o=t.token;return(!f||r.toLowerCase().includes(f.toLowerCase())||o.toLowerCase().includes(f.toLowerCase()))&&(e[n]||(e[n]=[]),e[n].push(t)),e}),{});return(0,h.jsxs)(D.Modal,{size:"medium",title:(0,b.__)("Personalization Tags","mailpoet"),onRequestClose:function(){r(),J("personalization_tags_modal_closed",{openedBy:c})},className:"mailpoet-personalization-tags-modal",children:[(0,h.jsxs)("p",{children:[(0,b.__)("Insert personalization tags to dynamically fill in information and personalize your emails.","mailpoet")," ",(0,h.jsx)(D.ExternalLink,{href:"https://kb.mailpoet.com/article/435-a-guide-to-personalisation-tags-for-tailored-newsletters#list",onClick:function(){return J("personalization_tags_modal_learn_more_link_clicked",{openedBy:c})},children:(0,b.__)("Learn more","mailpoet")})]}),(0,h.jsx)(D.SearchControl,{onChange:function(e){_(e),K("personalization_tags_modal_search_control_input_updated",{openedBy:c})},value:f}),(0,h.jsx)(V,{groupedTags:k,activeCategory:d,onCategorySelect:function(e){p(e),J("personalization_tags_modal_category_menu_clicked",{category:e,openedBy:c})}}),(0,h.jsx)(H,{groupedTags:k,activeCategory:d,onInsert:function(e){t(e),J("personalization_tags_modal_tag_insert_button_clicked",{insertedTag:e,activeCategory:d,openedBy:c})},closeCallback:r,canInsertLink:i,openLinkModal:function(e){y(e),w(!0)}})]})},ee=(n(609),function(e){var t=e.contentRef,n=e.onUpdate,r=N((0,l.useState)(!1),2),o=r[0],i=r[1],a=N((0,l.useState)(null),2),s=a[0],c=a[1],u=N((0,l.useState)(""),2),d=u[0],p=u[1],m=N((0,l.useState)(""),2),f=m[0],_=m[1];return(0,l.useEffect)((function(){if(t&&t.current){var e=t.current,n=function(e){var t=e.target.closest("span[data-rich-text-comment]");if(t){var n=t.innerText.replace(/^\[|\]$/g,"");_(n),p(n),c(t),i(!0)}};return e.addEventListener("click",n),function(){e.removeEventListener("click",n)}}}),[t]),(0,h.jsx)(h.Fragment,{children:o&&s&&(0,h.jsx)(D.Popover,{position:"bottom right",onClose:function(){return i(!1)},anchor:s,className:"mailpoet-personalization-tag-popover",children:(0,h.jsxs)("div",{className:"mailpoet-personalization-tag-popover__content",children:[(0,h.jsx)(D.TextControl,{label:(0,b.__)("Personalization Tag","mailpoet"),value:d,onChange:function(e){return p(e)},__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,h.jsxs)("div",{className:"mailpoet-personalization-tag-popover__content-buttons",children:[(0,h.jsx)(D.Button,{isTertiary:!0,onClick:function(){i(!1)},children:(0,b.__)("Cancel","mailpoet")}),(0,h.jsx)(D.Button,{isPrimary:!0,onClick:function(){n(f,d),i(!1)},children:(0,b.__)("Update","mailpoet")})]})]})})})}),te=function(e){var t=e.contentRef,n=e.onUpdate,r=N((0,l.useState)(!1),2),o=r[0],i=r[1],s=N((0,l.useState)(null),2),c=s[0],u=s[1],d=N((0,l.useState)(""),2),p=d[0],m=d[1],f=N((0,l.useState)(""),2),_=f[0],g=f[1],v=(0,a.useSelect)((function(e){return e(R).getPersonalizationTagsList()}),[]);return(0,l.useEffect)((function(){if(t&&t.current){var e=t.current,n=function(e){var t=e.target.closest("a[data-link-href]");t&&(u(t),g(t.getAttribute("data-link-href")||""),m(t.textContent||""),i(!0))};return e.addEventListener("click",n),function(){e.removeEventListener("click",n)}}}),[t]),(0,h.jsx)(h.Fragment,{children:o&&c&&(0,h.jsx)(D.Popover,{position:"bottom left",onClose:function(){return i(!1)},anchor:c,className:"mailpoet-personalization-tag-popover",children:(0,h.jsxs)("div",{className:"mailpoet-personalization-tag-popover__content",children:[(0,h.jsx)(D.TextControl,{label:(0,b.__)("Link Text","mailpoet"),value:p,onChange:function(e){return m(e)},__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,autoComplete:"off"}),(0,h.jsx)(D.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,b.__)("Link tag","mailpoet"),value:_,onChange:function(e){g(e)},options:v.filter((function(e){return e.category===(0,b.__)("Link","mailpoet")})).map((function(e){return{label:e.name,value:e.token}}))}),(0,h.jsxs)("div",{className:"mailpoet-personalization-tag-popover__content-buttons",children:[(0,h.jsx)(D.Button,{isTertiary:!0,onClick:function(){i(!1)},children:(0,b.__)("Cancel","mailpoet")}),(0,h.jsx)(D.Button,{isPrimary:!0,onClick:function(){i(!1),n(c,_,p)},children:(0,b.__)("Update link","mailpoet")})]})]})})})};function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oe(e){var t=e.contentRef,n=N((0,l.useState)(!1),2),r=n[0],o=n[1],i=(0,a.useSelect)((function(e){return e("core/block-editor").getSelectedBlockClientId()})),s=(0,a.useDispatch)("core/block-editor").updateBlockAttributes,c=(0,a.useSelect)((function(e){var t,n=e("core/block-editor").getBlockAttributes(i);return(null==n||null===(t=n.content)||void 0===t?void 0:t.originalHTML)||(null==n?void 0:n.content)||""})),u=(0,l.useCallback)((function(e,n){var r=B(t,c),o=r.start,a=r.end,l="";if(n){var u=(0,I.create)({html:c});u=(0,I.insert)(u,n,o,a),a=o+n.length,u=(0,I.applyFormat)(u,{type:"mailpoet-email-editor/link-shortcode",attributes:{"data-link-href":e,contenteditable:"false",style:"text-decoration: underline;"}},o,a),l=(0,I.toHTMLString)({value:u})}else{var d=(0,I.create)({html:c});d=(0,I.insert)(d,(0,I.create)({html:"\x3c!--".concat(e,"--\x3e&nbsp;")}),o,a),l=(0,I.toHTMLString)({value:d})}s(i,{content:l})}),[c,t,i,s]);return(0,h.jsx)(f.BlockControls,{children:(0,h.jsxs)(D.ToolbarGroup,{children:[(0,h.jsx)(D.ToolbarButton,{icon:"shortcode",title:(0,b.__)("Personalization Tags","mailpoet"),onClick:function(){o(!0),J("block_controls_personalization_tags_button_clicked")}}),(0,h.jsx)(ee,{contentRef:t,onUpdate:function(e,t){var n=c.replace("\x3c!--[".concat(e,"]--\x3e"),"\x3c!--[".concat(t,"]--\x3e"));s(i,{content:n})}}),(0,h.jsx)(te,{contentRef:t,onUpdate:function(e,t,n){var r=e.getAttribute("data-link-href").replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),o=new RegExp('<a([^>]*?)data-link-href="'.concat(r,'"([^>]*?)>').concat(e.textContent,"</a>"),"gi"),a=c.replace(o,(function(e,r,o){return"<a".concat(r,'data-link-href="').concat(t,'"').concat(o,">").concat(n,"</a>")}));s(i,{content:a})}}),(0,h.jsx)(Q,{isOpened:r,onInsert:function(e,t){u(e,t),o(!1)},closeCallback:function(){return o(!1)},canInsertLink:!0,openedBy:"block-controls"})]})})}var ie=(0,_.createHigherOrderComponent)((function(e){return function(t){var n=t.attributes,r=t.setAttributes,o=t.name,i=n.content,s=(0,a.useSelect)((function(e){return e(R).getPersonalizationTagsList()}),[]),c=(0,l.useCallback)((function(){return i?L(i,s):""}),[i,s]),u=(0,l.useCallback)((function(e){if(void 0!==e.content){var t=L(e.content,s);r(re(re({},e),{},{content:t}))}else r(e)}),[s,r]);return"core/paragraph"===o||"core/heading"===o||"core/list-item"===o?(0,h.jsx)(e,re(re({},t),{},{attributes:re(re({},n),{},{content:c()}),setAttributes:u})):(0,h.jsx)(e,re({},t))}}),"personalizationTagsLiveContentUpdate");function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pe=n(942),me=n.n(pe);const fe=window.wp.blocks,_e=window.wp.primitives,he=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M9 9v6h11V9H9zM4 20h1.5V4H4v16z"})}),ge=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M12.5 15v5H11v-5H4V9h7V4h1.5v5h7v6h-7Z"})}),ve=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M4 15h11V9H4v6zM18.5 4v16H20V4h-1.5z"})});function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xe="__experimentalEmailFlexLayout";function je(e){return(0,fe.hasBlockSupport)(e,xe)}function we(e){var t=e.justificationValue,n=e.onChange,r=e.isToolbar,o=void 0!==r&&r,i=[{value:"left",icon:he,label:(0,b.__)("Justify items left","mailpoet")},{value:"center",icon:ge,label:(0,b.__)("Justify items center","mailpoet")},{value:"right",icon:ve,label:(0,b.__)("Justify items right","mailpoet")}];if(o){var a=i.map((function(e){return e.value}));return(0,h.jsx)(f.JustifyContentControl,{value:t,onChange:n,allowedControls:a,popoverProps:{placement:"bottom-start"}})}return(0,h.jsx)(D.__experimentalToggleGroupControl,{__nextHasNoMarginBottom:!0,label:(0,b.__)("Justification","mailpoet"),value:t,onChange:n,className:"block-editor-hooks__flex-layout-justification-controls",children:i.map((function(e){var t=e.value,n=e.icon,r=e.label;return(0,h.jsx)(D.__experimentalToggleGroupControlOptionIcon,{value:t,icon:n,label:r},t)}))})}function Se(e){var t=e.setAttributes,n=e.attributes,r=e.name;if(!(0,fe.getBlockSupport)(r,xe,{}))return null;var o=(n.layout||{}).justifyContent,i=void 0===o?"left":o,a=function(e){t({layout:be(be({},n.layout),{},{justifyContent:e})})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(f.InspectorControls,{children:(0,h.jsx)(D.PanelBody,{title:(0,b.__)("Layout","mailpoet"),children:(0,h.jsx)(D.Flex,{children:(0,h.jsx)(D.FlexItem,{children:(0,h.jsx)(we,{justificationValue:i,onChange:a})})})})}),(0,h.jsx)(f.BlockControls,{group:"block",__experimentalShareWithChildBlocks:!0,children:(0,h.jsx)(we,{justificationValue:i,onChange:a,isToolbar:!0})})]})}function ke(e){return je(e.name)?be(be({},e),{},{attributes:be(be({},e.attributes),{},{layout:{type:"object"}})}):e}var Oe=(0,_.createHigherOrderComponent)((function(e){return function(t){return[je(t.name)&&(0,h.jsx)(Se,be({},t),"layout"),(0,h.jsx)(e,be({},t),"edit")]}}),"withLayoutControls");function Pe(e){var t=e.block,n=e.props,r=n.attributes.layout,o=(null==r?void 0:r.justifyContent)||"left",i="is-content-justification-".concat(o),a=me()(i,"is-layout-email-flex is-layout-flex");return(0,h.jsx)(t,be(be({},n),{},{className:a}))}var Ee=(0,_.createHigherOrderComponent)((function(e){return function(t){return je(t.name)?(0,h.jsx)(Pe,{block:e,props:t}):(0,h.jsx)(e,be({},t))}}),"withLayoutStyles");const Te=window.wp.editor,Ce=window.wp.coreData;var Ne=(0,window.wp.privateApis.__dangerousOptInToUnstableAPIsOnlyForCoreModules)("I acknowledge private features are not for use in themes or plugins and doing so will break in the next version of WordPress.","@wordpress/edit-site").unlock,Ie=Ne(f.privateApis).ExperimentalBlockCanvas,De=Ne(D.privateApis).Tabs,Me=Ne(f.privateApis).ColorPanel,Ae=Ne(f.privateApis).useGlobalStylesOutputWithConfig;function Be(e){return function(e){if(Array.isArray(e))return T(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const Le=window.wp.mediaUtils;function Re(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=Re(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}const ze=function(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=Re(e))&&(r&&(r+=" "),r+=t);return r},Fe=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})}),Ve=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M11.776 4.454a.25.25 0 01.448 0l2.069 4.192a.25.25 0 00.188.137l4.626.672a.25.25 0 01.139.426l-3.348 3.263a.25.25 0 00-.072.222l.79 4.607a.25.25 0 01-.362.263l-4.138-2.175a.25.25 0 00-.232 0l-4.138 2.175a.25.25 0 01-.363-.263l.79-4.607a.25.25 0 00-.071-.222L4.754 9.881a.25.25 0 01.139-.426l4.626-.672a.25.25 0 00.188-.137l2.069-4.192z"})}),He=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{fillRule:"evenodd",d:"M9.706 8.646a.25.25 0 01-.188.137l-4.626.672a.25.25 0 00-.139.427l3.348 3.262a.25.25 0 01.072.222l-.79 4.607a.25.25 0 00.362.264l4.138-2.176a.25.25 0 01.233 0l4.137 2.175a.25.25 0 00.363-.263l-.79-4.607a.25.25 0 01.072-.222l3.347-3.262a.25.25 0 00-.139-.427l-4.626-.672a.25.25 0 01-.188-.137l-2.069-4.192a.25.25 0 00-.448 0L9.706 8.646zM12 7.39l-.948 1.921a1.75 1.75 0 01-1.317.957l-2.12.308 1.534 1.495c.412.402.6.982.503 1.55l-.362 2.11 1.896-.997a1.75 1.75 0 011.629 0l1.895.997-.362-2.11a1.75 1.75 0 01.504-1.55l1.533-1.495-2.12-.308a1.75 1.75 0 01-1.317-.957L12 7.39z",clipRule:"evenodd"})}),Ge=window.wp.viewport,Ue=window.wp.preferences,We=window.wp.plugins,$e=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})}),qe=window.wp.deprecated;var Ze=n.n(qe);function Ye(e){return["core/edit-post","core/edit-site"].includes(e)?(Ze()(`${e} interface scope`,{alternative:"core interface scope",hint:"core/edit-post and core/edit-site are merging.",version:"6.6"}),"core"):e}function Je(e,t){return"core"===e&&"edit-site/template"===t?(Ze()("edit-site/template sidebar",{alternative:"edit-post/document",version:"6.6"}),"edit-post/document"):"core"===e&&"edit-site/block-inspector"===t?(Ze()("edit-site/block-inspector sidebar",{alternative:"edit-post/block",version:"6.6"}),"edit-post/block"):t}const Ke=(e,t)=>({type:"SET_DEFAULT_COMPLEMENTARY_AREA",scope:e=Ye(e),area:t=Je(e,t)}),Xe=(e,t)=>({registry:n,dispatch:r})=>{t&&(e=Ye(e),t=Je(e,t),n.select(Ue.store).get(e,"isComplementaryAreaVisible")||n.dispatch(Ue.store).set(e,"isComplementaryAreaVisible",!0),r({type:"ENABLE_COMPLEMENTARY_AREA",scope:e,area:t}))},Qe=e=>({registry:t})=>{e=Ye(e),t.select(Ue.store).get(e,"isComplementaryAreaVisible")&&t.dispatch(Ue.store).set(e,"isComplementaryAreaVisible",!1)},et=(e,t)=>({registry:n})=>{if(!t)return;e=Ye(e),t=Je(e,t);const r=n.select(Ue.store).get(e,"pinnedItems");!0!==r?.[t]&&n.dispatch(Ue.store).set(e,"pinnedItems",{...r,[t]:!0})},tt=(e,t)=>({registry:n})=>{if(!t)return;e=Ye(e),t=Je(e,t);const r=n.select(Ue.store).get(e,"pinnedItems");n.dispatch(Ue.store).set(e,"pinnedItems",{...r,[t]:!1})};function nt(e,t){return function({registry:n}){Ze()("dispatch( 'core/interface' ).toggleFeature",{since:"6.0",alternative:"dispatch( 'core/preferences' ).toggle"}),n.dispatch(Ue.store).toggle(e,t)}}function rt(e,t,n){return function({registry:r}){Ze()("dispatch( 'core/interface' ).setFeatureValue",{since:"6.0",alternative:"dispatch( 'core/preferences' ).set"}),r.dispatch(Ue.store).set(e,t,!!n)}}function ot(e,t){return function({registry:n}){Ze()("dispatch( 'core/interface' ).setFeatureDefaults",{since:"6.0",alternative:"dispatch( 'core/preferences' ).setDefaults"}),n.dispatch(Ue.store).setDefaults(e,t)}}function it(e){return{type:"OPEN_MODAL",name:e}}function at(){return{type:"CLOSE_MODAL"}}const lt=(0,a.createRegistrySelector)((e=>(t,n)=>{n=Ye(n);const r=e(Ue.store).get(n,"isComplementaryAreaVisible");if(void 0!==r)return!1===r?null:t?.complementaryAreas?.[n]})),st=(0,a.createRegistrySelector)((e=>(t,n)=>{n=Ye(n);const r=e(Ue.store).get(n,"isComplementaryAreaVisible"),o=t?.complementaryAreas?.[n];return r&&void 0===o})),ct=(0,a.createRegistrySelector)((e=>(t,n,r)=>{var o;r=Je(n=Ye(n),r);const i=e(Ue.store).get(n,"pinnedItems");return null===(o=i?.[r])||void 0===o||o})),ut=(0,a.createRegistrySelector)((e=>(t,n,r)=>(Ze()("select( 'core/interface' ).isFeatureActive( scope, featureName )",{since:"6.0",alternative:"select( 'core/preferences' ).get( scope, featureName )"}),!!e(Ue.store).get(n,r))));function dt(e,t){return e.activeModal===t}const pt=(0,a.combineReducers)({complementaryAreas:function(e={},t){switch(t.type){case"SET_DEFAULT_COMPLEMENTARY_AREA":{const{scope:n,area:r}=t;return e[n]?e:{...e,[n]:r}}case"ENABLE_COMPLEMENTARY_AREA":{const{scope:n,area:r}=t;return{...e,[n]:r}}}return e},activeModal:function(e=null,t){switch(t.type){case"OPEN_MODAL":return t.name;case"CLOSE_MODAL":return null}return e}}),mt=(0,a.createReduxStore)("core/interface",{reducer:pt,actions:e,selectors:t});function ft({as:e=D.Button,scope:t,identifier:n,icon:r,selectedIcon:o,name:i,shortcut:l,...s}){const c=e,u=(0,We.usePluginContext)(),d=r||u.icon,p=n||`${u.name}/${i}`,m=(0,a.useSelect)((e=>e(mt).getActiveComplementaryArea(t)===p),[p,t]),{enableComplementaryArea:f,disableComplementaryArea:_}=(0,a.useDispatch)(mt);return(0,h.jsx)(c,{icon:o&&m?o:d,"aria-controls":p.replace("/",":"),"aria-checked":(g=s.role,["checkbox","option","radio","switch","menuitemcheckbox","menuitemradio","treeitem"].includes(g)?m:void 0),onClick:()=>{m?_(t):f(t,p)},shortcut:l,...s});var g}(0,a.register)(mt);const _t=({children:e,className:t,toggleButtonProps:n})=>{const r=(0,h.jsx)(ft,{icon:$e,...n});return(0,h.jsxs)("div",{className:ze("components-panel__header","interface-complementary-area-header",t),tabIndex:-1,children:[e,r]})},ht=()=>{};function gt({name:e,as:t=D.Button,onClick:n,...r}){return(0,h.jsx)(D.Fill,{name:e,children:({onClick:e})=>(0,h.jsx)(t,{onClick:n||e?(...t)=>{(n||ht)(...t),(e||ht)(...t)}:void 0,...r})})}gt.Slot=function({name:e,as:t=D.ButtonGroup,fillProps:n={},bubblesVirtually:r,...o}){return(0,h.jsx)(D.Slot,{name:e,bubblesVirtually:r,fillProps:n,children:e=>{if(!l.Children.toArray(e).length)return null;const n=[];l.Children.forEach(e,(({props:{__unstableExplicitMenuItem:e,__unstableTarget:t}})=>{t&&e&&n.push(t)}));const r=l.Children.map(e,(e=>!e.props.__unstableExplicitMenuItem&&n.includes(e.props.__unstableTarget)?null:e));return(0,h.jsx)(t,{...o,children:r})}})};const vt=gt,yt=({__unstableExplicitMenuItem:e,__unstableTarget:t,...n})=>(0,h.jsx)(D.MenuItem,{...n});function bt({scope:e,target:t,__unstableExplicitMenuItem:n,...r}){return(0,h.jsx)(ft,{as:r=>(0,h.jsx)(vt,{__unstableExplicitMenuItem:n,__unstableTarget:`${e}/${t}`,as:yt,name:`${e}/plugin-more-menu`,...r}),role:"menuitemcheckbox",selectedIcon:Fe,name:t,scope:e,...r})}function xt({scope:e,...t}){return(0,h.jsx)(D.Fill,{name:`PinnedItems/${e}`,...t})}xt.Slot=function({scope:e,className:t,...n}){return(0,h.jsx)(D.Slot,{name:`PinnedItems/${e}`,...n,children:e=>e?.length>0&&(0,h.jsx)("div",{className:ze(t,"interface-pinned-items"),children:e})})};const jt=xt,wt={open:{width:280},closed:{width:0},mobileOpen:{width:"100vw"}};function St({activeArea:e,isActive:t,scope:n,children:r,className:o,id:i}){const a=(0,_.useReducedMotion)(),s=(0,_.useViewportMatch)("medium","<"),c=(0,_.usePrevious)(e),u=(0,_.usePrevious)(t),[,d]=(0,l.useState)({});(0,l.useEffect)((()=>{d({})}),[t]);const p={type:"tween",duration:a||s||c&&e&&e!==c?0:.3,ease:[.6,0,.4,1]};return(0,h.jsx)(D.Fill,{name:`ComplementaryArea/${n}`,children:(0,h.jsx)(D.__unstableAnimatePresence,{initial:!1,children:(u||t)&&(0,h.jsx)(D.__unstableMotion.div,{variants:wt,initial:"closed",animate:s?"mobileOpen":"open",exit:"closed",transition:p,className:"interface-complementary-area__fill",children:(0,h.jsx)("div",{id:i,className:o,style:{width:s?"100vw":280},children:r})})})})}function kt({children:e,className:t,closeLabel:n=(0,b.__)("Close plugin"),identifier:r,header:o,headerClassName:i,icon:s,isPinnable:c=!0,panelClassName:u,scope:d,name:p,title:m,toggleShortcut:f,isActiveByDefault:g}){const v=(0,We.usePluginContext)(),y=s||v.icon,x=r||`${v.name}/${p}`,[j,w]=(0,l.useState)(!1),{isLoading:S,isActive:k,isPinned:O,activeArea:P,isSmall:E,isLarge:T,showIconLabels:C}=(0,a.useSelect)((e=>{const{getActiveComplementaryArea:t,isComplementaryAreaLoading:n,isItemPinned:r}=e(mt),{get:o}=e(Ue.store),i=t(d);return{isLoading:n(d),isActive:i===x,isPinned:r(d,x),activeArea:i,isSmall:e(Ge.store).isViewportMatch("< medium"),isLarge:e(Ge.store).isViewportMatch("large"),showIconLabels:o("core","showIconLabels")}}),[x,d]),N=(0,_.useViewportMatch)("medium","<");!function(e,t,n,r,o){const i=(0,l.useRef)(!1),s=(0,l.useRef)(!1),{enableComplementaryArea:c,disableComplementaryArea:u}=(0,a.useDispatch)(mt);(0,l.useEffect)((()=>{r&&o&&!i.current?(u(e),s.current=!0):s.current&&!o&&i.current?(s.current=!1,c(e,t)):s.current&&n&&n!==t&&(s.current=!1),o!==i.current&&(i.current=o)}),[r,o,e,t,n,u,c])}(d,x,P,k,E);const{enableComplementaryArea:I,disableComplementaryArea:M,pinItem:A,unpinItem:B}=(0,a.useDispatch)(mt);if((0,l.useEffect)((()=>{g&&void 0===P&&!E?I(d,x):void 0===P&&E&&M(d,x),w(!0)}),[P,g,d,x,E,I,M]),j)return(0,h.jsxs)(h.Fragment,{children:[c&&(0,h.jsx)(jt,{scope:d,children:O&&(0,h.jsx)(ft,{scope:d,identifier:x,isPressed:k&&(!C||T),"aria-expanded":k,"aria-disabled":S,label:m,icon:C?Fe:y,showTooltip:!C,variant:C?"tertiary":void 0,size:"compact",shortcut:f})}),p&&c&&(0,h.jsx)(bt,{target:p,scope:d,icon:y,children:m}),(0,h.jsxs)(St,{activeArea:P,isActive:k,className:ze("interface-complementary-area",t),scope:d,id:x.replace("/",":"),children:[(0,h.jsx)(_t,{className:i,closeLabel:n,onClose:()=>M(d),toggleButtonProps:{label:n,size:"compact",shortcut:f,scope:d,identifier:x},children:o||(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("h2",{className:"interface-complementary-area-header__title",children:m}),c&&!N&&(0,h.jsx)(D.Button,{className:"interface-complementary-area__pin-unpin-item",icon:O?Ve:He,label:O?(0,b.__)("Unpin from toolbar"):(0,b.__)("Pin to toolbar"),onClick:()=>(O?B:A)(d,x),isPressed:O,"aria-expanded":O,size:"compact"})]})}),(0,h.jsx)(D.Panel,{className:u,children:e})]})]})}kt.Slot=function({scope:e,...t}){return(0,h.jsx)(D.Slot,{name:`ComplementaryArea/${e}`,...t})};const Ot=kt,Pt=({isActive:e})=>((0,l.useEffect)((()=>{let e=!1;return document.body.classList.contains("sticky-menu")&&(e=!0,document.body.classList.remove("sticky-menu")),()=>{e&&document.body.classList.add("sticky-menu")}}),[]),(0,l.useEffect)((()=>(e?document.body.classList.add("is-fullscreen-mode"):document.body.classList.remove("is-fullscreen-mode"),()=>{e&&document.body.classList.remove("is-fullscreen-mode")})),[e]),null),Et=(0,l.forwardRef)((({children:e,className:t,ariaLabel:n,as:r="div",...o},i)=>(0,h.jsx)(r,{ref:i,className:ze("interface-navigable-region",t),"aria-label":n,role:"region",tabIndex:"-1",...o,children:e})));Et.displayName="NavigableRegion";const Tt=Et,Ct={type:"tween",duration:.25,ease:[.6,0,.4,1]},Nt={hidden:{opacity:1,marginTop:-60},visible:{opacity:1,marginTop:0},distractionFreeHover:{opacity:1,marginTop:0,transition:{...Ct,delay:.2,delayChildren:.2}},distractionFreeHidden:{opacity:0,marginTop:-60},distractionFreeDisabled:{opacity:0,marginTop:0,transition:{...Ct,delay:.8,delayChildren:.8}}},It=(0,l.forwardRef)((function({isDistractionFree:e,footer:t,header:n,editorNotices:r,sidebar:o,secondarySidebar:i,content:a,actions:s,labels:c,className:u},d){const[p,m]=(0,_.useResizeObserver)(),f=(0,_.useViewportMatch)("medium","<"),g={type:"tween",duration:(0,_.useReducedMotion)()?0:.25,ease:[.6,0,.4,1]};!function(e){(0,l.useEffect)((()=>{const t=document&&document.querySelector(`html:not(.${e})`);if(t)return t.classList.toggle(e),()=>{t.classList.toggle(e)}}),[e])}("interface-interface-skeleton__html-container");const v={
/* translators: accessibility text for the top bar landmark region. */
header:(0,b._x)("Header","header landmark area"),
/* translators: accessibility text for the content landmark region. */
body:(0,b.__)("Content"),
/* translators: accessibility text for the secondary sidebar landmark region. */
secondarySidebar:(0,b.__)("Block Library"),
/* translators: accessibility text for the settings landmark region. */
sidebar:(0,b._x)("Settings","settings landmark area"),
/* translators: accessibility text for the publish landmark region. */
actions:(0,b.__)("Publish"),
/* translators: accessibility text for the footer landmark region. */
footer:(0,b.__)("Footer"),...c};return(0,h.jsxs)("div",{ref:d,className:ze(u,"interface-interface-skeleton",!!t&&"has-footer"),children:[(0,h.jsxs)("div",{className:"interface-interface-skeleton__editor",children:[(0,h.jsx)(D.__unstableAnimatePresence,{initial:!1,children:!!n&&(0,h.jsx)(Tt,{as:D.__unstableMotion.div,className:"interface-interface-skeleton__header","aria-label":v.header,initial:e&&!f?"distractionFreeHidden":"hidden",whileHover:e&&!f?"distractionFreeHover":"visible",animate:e&&!f?"distractionFreeDisabled":"visible",exit:e&&!f?"distractionFreeHidden":"hidden",variants:Nt,transition:g,children:n})}),e&&(0,h.jsx)("div",{className:"interface-interface-skeleton__header",children:r}),(0,h.jsxs)("div",{className:"interface-interface-skeleton__body",children:[(0,h.jsx)(D.__unstableAnimatePresence,{initial:!1,children:!!i&&(0,h.jsx)(Tt,{className:"interface-interface-skeleton__secondary-sidebar",ariaLabel:v.secondarySidebar,as:D.__unstableMotion.div,initial:"closed",animate:"open",exit:"closed",variants:{open:{width:m.width},closed:{width:0}},transition:g,children:(0,h.jsxs)(D.__unstableMotion.div,{style:{position:"absolute",width:f?"100vw":"fit-content",height:"100%",left:0},variants:{open:{x:0},closed:{x:"-100%"}},transition:g,children:[p,i]})})}),(0,h.jsx)(Tt,{className:"interface-interface-skeleton__content",ariaLabel:v.body,children:a}),!!o&&(0,h.jsx)(Tt,{className:"interface-interface-skeleton__sidebar",ariaLabel:v.sidebar,children:o}),!!s&&(0,h.jsx)(Tt,{className:"interface-interface-skeleton__actions",ariaLabel:v.actions,children:s})]})]}),!!t&&(0,h.jsx)(Tt,{className:"interface-interface-skeleton__footer",ariaLabel:v.footer,children:t})]})}));var Dt=n(744),Mt=n.n(Dt);function At(){var e=(0,a.useSelect)((function(e){return{globalStylePost:e(R).getGlobalEmailStylesPost()}}),[]).globalStylePost,t=(0,l.useCallback)((function(t){e&&(0,a.dispatch)(Ce.store).editEntityRecord("postType","wp_global_styles",e.id,{styles:t.styles,settings:t.settings})}),[e]);return{userTheme:{settings:null==e?void 0:e.settings,styles:null==e?void 0:e.styles},updateUserTheme:t}}function Bt(){var e=At().userTheme,t=(0,a.useSelect)((function(e){return{editorTheme:e(R).getTheme()}}),[]).editorTheme,n=(0,l.useMemo)((function(){return Mt().all([{},t||{},e||{}])}),[t,e]);return[N(Ae(n),1)[0]||[]]}function Lt(){var e=(0,a.useSelect)((function(e){return{hasEdits:e(R).hasEdits(),autosaveInterval:e(R).getAutosaveInterval()}}),[]),t=e.hasEdits,n=e.autosaveInterval,r=(0,a.useDispatch)(R).saveEditedEmail;return(0,l.useEffect)((function(){var e;return t&&n>0&&(e=setTimeout((function(){r(),J("editor_content_auto_saved")}),1e3*n)),function(){e&&clearTimeout(e)}}),[t,n,r]),null}const Rt=(0,h.jsx)(_e.SVG,{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-4 14.5H6c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h8v13zm4.5-.5c0 .3-.2.5-.5.5h-2.5v-13H18c.3 0 .5.2.5.5v12z"})});function zt(){return[(0,a.useSelect)((function(e){return{isEditingTemplate:"wp_template"===e(Te.store).getCurrentPostType()}}),[]).isEditingTemplate?"template":"email"]}var Ft=l.forwardRef((function(e,t){var n=N(zt(),1)[0];return(0,h.jsxs)(De.TabList,{ref:t,children:[(0,h.jsx)(De.Tab,{tabId:z,children:"template"===n?(0,b.__)("Template","mailpoet"):(0,b.__)("Email","mailpoet")}),(0,h.jsx)(De.Tab,{tabId:F,children:(0,b.__)("Block")})]})}));function Vt(e){var t,n=e.label,r=e.labelSuffix,o=e.help,i=e.placeholder,s=e.attributeName,c=N((0,Ce.useEntityProp)("postType","mailpoet_email","mailpoet_data"),1)[0],u=(0,a.useDispatch)(R).updateEmailMailPoetProperty,d=N((0,l.useState)(null),2),p=d[0],m=d[1],_=N((0,l.useState)(!1),2),g=_[0],v=_[1],y=(0,a.useSelect)((function(e){return e(R).getPersonalizationTagsList()}),[]),x=(0,l.useRef)(null),j=(0,l.useCallback)((function(e,t,n){var r,o,i=null!==(r=null==n?void 0:n.start)&&void 0!==r?r:t.length,a=null!==(o=null==n?void 0:n.end)&&void 0!==o?o:t.length,l=(0,I.create)({html:t});l=(0,I.insert)(l,(0,I.create)({html:"\x3c!--".concat(e,"--\x3e")}),i,a);var c=(0,I.toHTMLString)({value:l});u(s,c),m(null)}),[s,u]),w=(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{children:n}),(0,h.jsx)(D.Button,{className:"mailpoet-settings-panel__personalization-tags-button",icon:"shortcode",title:(0,b.__)("Personalization Tags","mailpoet"),onClick:function(){v(!0),J("rich_text_with_button_personalization_tags_shortcode_icon_clicked",{attributeName:s,label:n})}}),r]});return c?(0,h.jsxs)(D.BaseControl,{id:"mailpoet-settings-panel__".concat(s),label:w,className:"mailpoet-settings-panel__".concat(s,"-text"),help:o,__nextHasNoMarginBottom:!0,children:[(0,h.jsx)(Q,{isOpened:g,onInsert:function(e){var t;j(e,null!==(t=c[s])&&void 0!==t?t:"",p),v(!1),J("rich_text_with_button_personalization_tags_inserted",{attributeName:s,value:e})},closeCallback:function(){return v(!1)},openedBy:"RichTextWithButton-BaseControl"}),(0,h.jsx)(ee,{contentRef:x,onUpdate:function(e,t){var n,r=(null!==(n=c[s])&&void 0!==n?n:"").replace("\x3c!--[".concat(e,"]--\x3e"),"\x3c!--[".concat(t,"]--\x3e"));u(s,r)}}),(0,h.jsx)(f.RichText,{ref:x,className:"mailpoet-settings-panel__richtext",placeholder:i,onFocus:function(){var e;m(B(x,null!==(e=c[s])&&void 0!==e?e:""))},onKeyUp:function(){var e;m(B(x,null!==(e=c[s])&&void 0!==e?e:""))},onClick:function(){var e;m(B(x,null!==(e=c[s])&&void 0!==e?e:""))},onChange:function(e){var t;e=L(null!==(t=e)&&void 0!==t?t:"",y),u(s,e),K("rich_text_with_button_input_field_updated",{attributeName:s})},value:null!==(t=c[s])&&void 0!==t?t:"","data-automation-id":"email_".concat(s)})]}):null}function Ht(){var e,t,n=N((0,Ce.useEntityProp)("postType","mailpoet_email","mailpoet_data"),1)[0],r=(0,l.createInterpolateElement)((0,b.__)("Use personalization tags to personalize your email, or learn more about <bestPracticeLink>best practices</bestPracticeLink> and using <emojiLink>emoji in subject lines</emojiLink>.","mailpoet"),{bestPracticeLink:(0,h.jsx)("a",{href:"https://www.mailpoet.com/blog/17-email-subject-line-best-practices-to-boost-engagement/",target:"_blank",rel:"noopener noreferrer",onClick:function(){return J("details_panel_subject_help_best_practice_link_clicked")}}),emojiLink:(0,h.jsx)("a",{href:"https://www.mailpoet.com/blog/tips-using-emojis-in-subject-lines/",target:"_blank",rel:"noopener noreferrer",onClick:function(){return J("details_panel_subject_help_emoji_in_subject_lines_link_clicked")}})}),o=null!==(e=null==n||null===(t=n.preheader)||void 0===t?void 0:t.length)&&void 0!==e?e:0,i=(0,l.createInterpolateElement)((0,b.__)("<link>This text</link> will appear in the inbox, underneath the subject line.","mailpoet"),{link:(0,h.jsx)("a",{href:new URL("article/418-preview-text","https://kb.mailpoet.com/").toString(),target:"_blank",rel:"noopener noreferrer",onClick:function(){return J("details_panel_preheader_help_text_link_clicked")}},"preview-text-kb")});return(0,h.jsxs)(D.PanelBody,{title:(0,b.__)("Details","mailpoet"),className:"mailpoet-email-editor__settings-panel",onToggle:function(e){return J("details_panel_body_toggle",{opened:e})},children:[(0,h.jsx)(Vt,{attributeName:"subject",label:(0,b.__)("Subject","mailpoet"),labelSuffix:(0,h.jsx)(D.ExternalLink,{href:"https://kb.mailpoet.com/article/435-a-guide-to-personalisation-tags-for-tailored-newsletters#list",onClick:function(){return J("details_panel_personalisation_tags_guide_link_clicked")},children:(0,b.__)("Guide","mailpoet")}),help:r,placeholder:(0,b.__)("Eg. The summer sale is here!","mailpoet")}),(0,h.jsx)(Vt,{attributeName:"preheader",label:(0,b.__)("Preview text","mailpoet"),labelSuffix:(0,h.jsxs)("span",{className:me()("mailpoet-settings-panel__preview-text-length",{"mailpoet-settings-panel__preview-text-length-warning":o>80,"mailpoet-settings-panel__preview-text-length-error":o>150}),children:[o,"/",150]}),help:i,placeholder:(0,b.__)("Add a preview text to capture subscribers' attention and increase open rates.","mailpoet")})]})}const Gt=(0,l.forwardRef)((function({icon:e,size:t=24,...n},r){return(0,l.cloneElement)(e,{width:t,height:t,...n,ref:r})})),Ut=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{fillRule:"evenodd",d:"M6.863 13.644L5 13.25h-.5a.5.5 0 01-.5-.5v-3a.5.5 0 01.5-.5H5L18 6.5h2V16h-2l-3.854-.815.026.008a3.75 3.75 0 01-7.31-1.549zm1.477.313a2.251 2.251 0 004.356.921l-4.356-.921zm-2.84-3.28L18.157 8h.343v6.5h-.343L5.5 11.823v-1.146z",clipRule:"evenodd"})});function Wt(e){var t=e.close;K("edit_template_modal_opened");var n=(0,a.useSelect)((function(e){return{onNavigateToEntityRecord:(0,e(Te.store).getEditorSettings)().onNavigateToEntityRecord,template:e(R).getCurrentTemplate()}}),[]),r=n.onNavigateToEntityRecord,o=n.template;return(0,h.jsxs)(D.Modal,{size:"medium",onRequestClose:t,__experimentalHideHeader:!0,children:[(0,h.jsx)("p",{children:(0,b.__)("Note that the same template can be used by multiple emails, so any changes made here may affect other emails on the site. To switch back to editing the page content click the Back button in the toolbar.","mailpoet")}),(0,h.jsxs)(D.Flex,{justify:"end",children:[(0,h.jsx)(D.FlexItem,{children:(0,h.jsx)(D.Button,{variant:"tertiary",onClick:function(){J("edit_template_modal_cancel_button_clicked"),t()},children:(0,b.__)("Cancel","mailpoet")})}),(0,h.jsx)(D.FlexItem,{children:(0,h.jsx)(D.Button,{variant:"primary",onClick:function(){J("edit_template_modal_continue_button_clicked",{templateId:o.id}),r({postId:o.id,postType:"wp_template"})},disabled:!o.id,children:(0,b.__)("Continue","mailpoet")})})]})]})}function $t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$t(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zt(e,t){return e.map((function(e){var n;return"core/post-content"===e.name?qt(qt({},e),{},{name:"core/group",innerBlocks:t}):null!==(n=e.innerBlocks)&&void 0!==n&&n.length?qt(qt({},e),{},{innerBlocks:Zt(e.innerBlocks,t)}):e}))}var Yt={};const Jt=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M19 8h-1V6h-5v2h-2V6H6v2H5c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2zm.5 10c0 .3-.2.5-.5.5H5c-.3 0-.5-.2-.5-.5v-8c0-.3.2-.5.5-.5h14c.3 0 .5.2.5.5v8z"})}),Kt=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"})});var Xt=(0,window.wp.priorityQueue.createQueue)();function Qt(e){var t=e.children,n=e.placeholder,r=N((0,l.useState)(!1),2),o=r[0],i=r[1];return(0,l.useEffect)((function(){var e={};return Xt.add(e,(function(){(0,l.flushSync)((function(){i(!0)}))})),function(){Xt.cancel(e)}}),[]),o?t:n}function en(){return(0,h.jsxs)("div",{className:"block-editor-inserter__no-results",children:[(0,h.jsx)(Gt,{className:"block-editor-inserter__no-results-icon",icon:Jt}),(0,h.jsx)("p",{children:(0,b.__)("No recent templates.")}),(0,h.jsx)("p",{children:(0,b.__)("Your recent creations will appear here as soon as you begin.")})]})}var tn=(0,l.memo)((function(e){var t=e.templates,n=e.onTemplateSelection,r=e.selectedCategory,o=(0,a.useSelect)((function(e){return{layout:(0,e(Te.store).getEditorSettings)().__experimentalFeatures.layout}})).layout,i=N(Bt(),1)[0].reduce((function(e,t){var n;return e+(null!==(n=t.css)&&void 0!==n?n:"")}),"")+".is-root-container { width: ".concat(o.contentSize,"; margin: 0 auto; }");return"recent"===r&&0===t.length?(0,h.jsx)(en,{}):(0,h.jsx)("div",{className:"block-editor-block-patterns-list",role:"listbox",children:t.map((function(e){return(0,h.jsx)("div",{className:"block-editor-block-patterns-list__list-item email-editor-pattern__list-item",children:(0,h.jsx)("div",{className:"block-editor-block-patterns-list__item",role:"button",tabIndex:0,onClick:function(){n(e)},onKeyPress:function(t){"Enter"!==t.key&&" "!==t.key||n(e)},children:(0,h.jsxs)(Qt,{placeholder:(0,h.jsx)("p",{children:(0,b.__)("rendering template","mailpoet")}),children:[(0,h.jsx)(f.BlockPreview,{blocks:e.previewContentParsed,viewportWidth:900,minHeight:300,additionalStyles:[{css:i}]}),(0,h.jsx)(D.__experimentalHStack,{className:"block-editor-patterns__pattern-details",children:(0,h.jsx)("h4",{className:"block-editor-block-patterns-list__item-title",children:e.displayName})})]})})},"".concat(e.slug,"_").concat(e.displayName,"_").concat(e.id))}))})}),(function(e,t){return e.templates.length===t.templates.length&&e.selectedCategory===t.selectedCategory}));function nn(e){var t=e.templates,n=e.onTemplateSelection,r=e.selectedCategory,o=(0,l.useMemo)((function(){return t.filter((function(e){return e.category===r}))}),[r,t]);return(0,h.jsxs)("div",{className:"block-editor-block-patterns-explorer__list",children:["recent"===r&&(0,h.jsx)("div",{className:"email-editor-recent-templates-info",children:(0,h.jsxs)(D.__experimentalHStack,{spacing:1,expanded:!1,justify:"start",children:[(0,h.jsx)(Gt,{icon:Kt}),(0,h.jsx)("p",{children:(0,b.__)("Templates created on the legacy editor will not appear here.","mailpoet")})]})}),(0,h.jsx)(tn,{templates:o,onTemplateSelection:n,selectedCategory:r})]})}function rn(e){var t=e.selectedCategory,n=e.templateCategories,r=e.onClickCategory,o="block-editor-block-patterns-explorer__sidebar";return(0,h.jsx)("div",{className:o,children:(0,h.jsx)("div",{className:"".concat(o,"__categories-list"),children:n.map((function(e){var n=e.name,i=e.label;return(0,h.jsx)(D.Button,{label:i,className:"".concat(o,"__categories-list__item"),isPressed:t===n,onClick:function(){r(n)},children:i},n)}))})})}var on=[{name:"recent",label:"Recent"},{name:"basic",label:"Basic"}],an=(0,l.memo)((function(e){var t=e.hasEmailPosts,n=e.templates,r=e.handleTemplateSelection,o=N((0,l.useState)(on[1].name),2),i=o[0],a=o[1];return(0,l.useEffect)((function(){setTimeout((function(){t&&a(on[0].name)}),1e3)}),[t]),(0,h.jsxs)("div",{className:"block-editor-block-patterns-explorer",children:[(0,h.jsx)(rn,{templateCategories:on,selectedCategory:i,onClickCategory:function(e){J("template_select_modal_category_change",{category:e}),a(e)}}),(0,h.jsx)(nn,{templates:n,onTemplateSelection:r,selectedCategory:i})]})}));function ln(e){var t=e.onSelectCallback,n=e.closeCallback,r=void 0===n?null:n,o=e.previewContent,i=void 0===o?"":o,s=i?"swap":"new";K("template_select_modal_opened",{templateSelectMode:s});var c=N(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=(0,a.useSelect)((function(e){var t,n=null===(t=e(f.store).getBlocksByName("core/post-content"))||void 0===t?void 0:t[0],r=e(R).getSentEmailEditorPosts();return{templates:e(R).getEmailTemplates(),patterns:e(f.store).getPatternsByBlockTypes(["core/post-content"],n),emailPosts:r,hasEmailPosts:!(!r||null==r||!r.length)}}),[]),n=t.templates,r=t.patterns,o=t.emailPosts,i=t.hasEmailPosts,s=(0,l.useMemo)((function(){var t,o,i=e&&(0,fe.parse)(e);if(!(o=i?[{blocks:i}]:r.filter((function(e){var t;return null==e||null===(t=e.templateTypes)||void 0===t?void 0:t.includes("email-template")})))||!n)return[];var a=[];return null==n||null===(t=n.filter((function(e){return"email-general"!==e.slug})))||void 0===t||t.forEach((function(e){var t;null===(t=o)||void 0===t||t.forEach((function(t){var n,r=(0,fe.parse)(null===(n=e.content)||void 0===n?void 0:n.raw);r=Zt(r,t.blocks),a.push({id:e.id,slug:e.slug,previewContentParsed:r,emailParsed:t.blocks,template:e,category:"basic",type:e.type,displayName:t.title?"".concat(e.title.rendered," - ").concat(t.title):e.title.rendered})}))})),a}),[n,r,e]),c=(0,l.useMemo)((function(){return null==o?void 0:o.map((function(e){var t,n,r,o,i,a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.template,r={postTemplateContent:null};if(!n)return r;if(Yt[n])return Yt[n];var o=t.find((function(e){return e.slug===n}));if(!o)return r;var i={postTemplateContent:null==o?void 0:o.template};return Yt[n]=i,i}(e,s),l=a.postTemplateContent,c=(0,fe.parse)(null===(t=e.content)||void 0===t?void 0:t.raw),u=c;null!=l&&null!==(n=l.content)&&void 0!==n&&n.raw&&(u=Zt((0,fe.parse)(null==l||null===(i=l.content)||void 0===i?void 0:i.raw),c));var d=qt(qt({},e),{},{title:{raw:(null==e||null===(r=e.mailpoet_data)||void 0===r?void 0:r.subject)||e.title.raw,rendered:(null==e||null===(o=e.mailpoet_data)||void 0===o?void 0:o.subject)||e.title.rendered}});return{id:e.id,slug:e.slug,previewContentParsed:u,emailParsed:c,category:"recent",type:e.type,displayName:d.title.rendered,template:d}}))}),[o,s]);return[s||[],c||[],i]}(i),3),u=c[0],d=c[1],p=c[2],m=(null==u?void 0:u.length)>0,_=function(e){var n="mailpoet_email"===e.type,r=e.template;J("template_select_modal_template_selected",{templateSlug:e.slug,templateSelectMode:s,templateType:e.type}),i||(0,a.dispatch)(Te.store).resetEditorBlocks(e.emailParsed),(0,a.dispatch)(R).setTemplateToPost(n?r.template:e.slug),t()},g=function(){var e,t=null!==(e=u[0])&&void 0!==e?e:null;t&&(J("template_select_modal_handle_close_without_template_selected"),_(t))};return(0,h.jsxs)(D.Modal,{title:(0,b.__)("Start with an email preset","mailpoet"),onRequestClose:function(){return J("template_select_modal_closed",{templateSelectMode:s}),r?r():g()},isFullScreen:!0,children:[(0,h.jsx)(an,{hasEmailPosts:p,templates:[].concat(Be(u),Be(d)),handleTemplateSelection:_}),(0,h.jsx)(D.Flex,{className:"email-editor-modal-footer",justify:"flex-end",children:(0,h.jsx)(D.FlexItem,{children:(0,h.jsx)(D.Button,{variant:"tertiary",className:"email-editor-start_from_scratch_button",onClick:function(){return J("template_select_modal_start_from_scratch_clicked"),g()},isBusy:!m,children:(0,b.__)("Start from scratch","mailpoet")})})})]})}function sn(){var e=(0,a.useSelect)((function(e){return{template:e(R).getCurrentTemplate(),currentEmailContent:e(R).getEditedEmailContent()}}),[]),t=e.template,n=e.currentEmailContent,r=N((0,l.useState)(!1),2),o=r[0],i=r[1],s=N((0,l.useState)(!1),2),c=s[0],u=s[1];return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(D.Panel,{className:"mailpoet-email-sidebar__email-type-info",children:(0,h.jsxs)(D.PanelBody,{children:[(0,h.jsxs)(D.PanelRow,{children:[(0,h.jsx)("span",{className:"mailpoet-email-type-info__icon",children:(0,h.jsx)(Gt,{icon:Ut})}),(0,h.jsxs)("div",{className:"mailpoet-email-type-info__content",children:[(0,h.jsx)("h2",{children:(0,b.__)("Newsletter","mailpoet")}),(0,h.jsx)("span",{children:(0,b.__)("Send or schedule a newsletter to connect with your subscribers.","mailpoet")})]})]}),t&&(0,h.jsx)(D.PanelRow,{children:(0,h.jsxs)(D.Flex,{justify:"start",children:[(0,h.jsx)(D.FlexItem,{className:"editor-post-panel__row-label",children:(0,b.__)("Template","mailpoet")}),(0,h.jsx)(D.FlexItem,{children:(0,h.jsx)(D.DropdownMenu,{icon:null,text:null==t?void 0:t.title,toggleProps:{variant:"tertiary"},label:(0,b.__)("Template actions","mailpoet"),onToggle:function(e){return J("sidebar_template_actions_clicked",{currentTemplate:null==t?void 0:t.title,isOpen:e})},children:function(e){var t=e.onClose;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(D.MenuItem,{onClick:function(){J("sidebar_template_actions_edit_template_clicked"),i(!0),t()},children:(0,b.__)("Edit template","mailpoet")}),(0,h.jsx)(D.MenuItem,{onClick:function(){J("sidebar_template_actions_swap_template_clicked"),u(!0),t()},children:(0,b.__)("Swap template","mailpoet")})]})}})})]})})]})}),o&&(0,h.jsx)(Wt,{close:function(){return J("edit_template_modal_closed"),i(!1)}}),c&&(0,h.jsx)(ln,{onSelectCallback:function(){return u(!1)},closeCallback:function(){return u(!1)},previewContent:n})]})}function cn(){return(0,h.jsxs)(D.Panel,{children:[(0,h.jsx)(sn,{}),(0,h.jsx)(Ht,{})]})}const un=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M18 5.5H6a.5.5 0 00-.5.5v3h13V6a.5.5 0 00-.5-.5zm.5 5H10v8h8a.5.5 0 00.5-.5v-7.5zm-10 0h-3V18a.5.5 0 00.5.5h2.5v-8zM6 4h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2z"})}),dn=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M13 19h-2v-2h2v2zm0-6h-2v-2h2v2zm0-6h-2V5h2v2z"})});function pn(e,t,n,r,o,i,a){try{var l=e[i](a),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,o)}function mn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){pn(i,r,o,a,l,"next",e)}function l(e){pn(i,r,o,a,l,"throw",e)}a(void 0)}))}}const fn=window.regeneratorRuntime;var hn=n.n(fn);function gn(e){var t=e.close,n=(0,a.useSelect)((function(e){return e(R).getCurrentTemplate()}),[]),r=(0,a.useDispatch)(R).revertAndSaveTemplate;return(0,h.jsxs)(D.Modal,{size:"medium",onRequestClose:t,__experimentalHideHeader:!0,children:[(0,h.jsx)("p",{children:(0,b.__)("This will clear ANY and ALL template customization. All updates made to the template will be lost. Do you want to proceed?","mailpoet")}),(0,h.jsxs)(D.Flex,{justify:"end",children:[(0,h.jsx)(D.FlexItem,{children:(0,h.jsx)(D.Button,{variant:"tertiary",onClick:t,children:(0,b.__)("Cancel","mailpoet")})}),(0,h.jsx)(D.FlexItem,{children:(0,h.jsx)(D.Button,{variant:"primary",onClick:mn(hn().mark((function e(){return hn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(n);case 2:t();case 3:case"end":return e.stop()}}),e)}))),children:(0,b.__)("Reset","mailpoet")})})]})]})}function vn(){var e=(0,a.useSelect)((function(e){return e(R).getCurrentTemplate()}),[]),t=N((0,l.useState)(!1),2),n=t[0],r=t[1],o=(null==e?void 0:e.description)||"";return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(D.Panel,{className:"mailpoet-email-sidebar__email-type-info",children:(0,h.jsx)(D.PanelBody,{children:(0,h.jsxs)(D.PanelRow,{children:[(0,h.jsx)("span",{className:"mailpoet-email-type-info__icon",children:(0,h.jsx)(Gt,{icon:un})}),(0,h.jsxs)("div",{className:"mailpoet-email-type-info__content",children:[(0,h.jsxs)("div",{className:"mailpoet-email-type-info__content_heading",children:[(0,h.jsx)("h2",{children:(null==e?void 0:e.title)||(0,b.__)("Template","mailpoet")}),(0,h.jsx)(D.DropdownMenu,{icon:dn,label:(0,b.__)("Template actions","mailpoet"),children:function(e){var t=e.onClose;return(0,h.jsx)(D.MenuItem,{onClick:function(){r(!0),t()},info:(0,b.__)("Reset to default to clear all customizations","mailpoet"),children:(0,b.__)("Reset","mailpoet")})}})]}),o&&(0,h.jsx)("p",{children:o||""}),(0,h.jsx)("p",{children:(0,b.__)("Edit this template to be used across multiple emails.","mailpoet")})]})]})})}),n&&(0,h.jsx)(gn,{close:function(){r(!1)}})]})}function yn(){return(0,h.jsx)(D.Panel,{children:(0,h.jsx)(vn,{})})}function bn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bn(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jn(e){var t=N(zt(),1)[0],n=(0,l.useRef)(null),r=(0,l.useContext)(De.Context);return(0,h.jsx)(Ot,xn(xn({identifier:"email-editor/editor/main",closeLabel:(0,b.__)("Close sidebar","mailpoet"),headerClassName:"editor-sidebar__panel-tabs",className:"edit-post-sidebar",header:(0,h.jsx)(De.Context.Provider,{value:r,children:(0,h.jsx)(Ft,{ref:n})}),icon:Rt,scope:R,smallScreenTitle:(0,b.__)("No title","mailpoet"),isActiveByDefault:!0},e),{},{children:(0,h.jsxs)(De.Context.Provider,{value:r,children:[(0,h.jsx)(De.TabPanel,{tabId:z,children:"template"===t?(0,h.jsx)(yn,{}):(0,h.jsx)(cn,{})}),(0,h.jsx)(De.TabPanel,{tabId:F,children:(0,h.jsx)(f.BlockInspector,{})})]})}))}var wn=(0,l.memo)((function(e){var t=(0,a.useDispatch)(R).toggleSettingsSidebarActiveTab,n=(0,a.useSelect)((function(e){return{activeTab:e(R).getSettingsSidebarActiveTab(),selectedBlockId:e(f.store).getSelectedBlockClientId()}}),[]),r=n.activeTab,o=n.selectedBlockId;return(0,l.useEffect)((function(){t(o?F:z)}),[o,t]),(0,h.jsx)(De,{selectedTabId:r||z,onSelect:function(e){return J("sidebar_tab_selected",{tabKey:e}),t(e)},children:(0,h.jsx)(jn,xn({},e))})}));function Sn(){var e,t,n=(0,a.useSelect)((function(e){return e("core/block-editor").getSelectedBlock()}),[]),r=(0,fe.hasBlockSupport)(null==n?void 0:n.name,"border",!1)||(0,fe.hasBlockSupport)(null==n?void 0:n.name,"__experimentalBorder",!1);return(0,h.jsxs)(h.Fragment,{children:[r&&(0,h.jsx)(D.Fill,{name:"InspectorControlsBorder",children:(0,h.jsx)(D.Notice,{className:"mailpoet__grid-full-width",status:"warning",isDismissible:!1,children:(0,b.__)("Border display may vary or be unsupported in some email clients.","mailpoet")})}),(e=null==n?void 0:n.name,t=(0,fe.getBlockSupport)(e,"background"),t&&!1!==(null==t?void 0:t.backgroundImage)&&(0,h.jsx)(D.Fill,{name:"InspectorControlsBackground",children:(0,h.jsx)(D.Notice,{className:"mailpoet__grid-full-width",status:"warning",isDismissible:!1,children:(0,b.__)("Select a background color for email clients that do not support background images.","mailpoet")})}))]})}const kn=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),On=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M18.3 11.7c-.6-.6-1.4-.9-2.3-.9H6.7l2.9-3.3-1.1-1-4.5 5L8.5 16l1-1-2.7-2.7H16c.5 0 .9.2 1.3.5 1 1 1 3.4 1 4.5v.3h1.5v-.2c0-1.5 0-4.3-1.5-5.7z"})}),Pn=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M15.6 6.5l-1.1 1 2.9 3.3H8c-.9 0-1.7.3-2.3.9-1.4 1.5-1.4 4.2-1.4 5.6v.2h1.5v-.3c0-1.1 0-3.5 1-4.5.3-.3.7-.5 1.3-.5h9.2L14.5 15l1.1 1.1 4.6-4.6-4.6-5z"})}),En=(0,h.jsx)(_e.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)(_e.Path,{d:"M3 6h11v1.5H3V6Zm3.5 5.5h11V13h-11v-1.5ZM21 17H10v1.5h11V17Z"})}),Tn=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M6.6 6L5.4 7l4.5 5-4.5 5 1.1 1 5.5-6-5.4-6zm6 0l-1.1 1 4.5 5-4.5 5 1.1 1 5.5-6-5.5-6z"})}),Cn=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M11.6 7l-1.1-1L5 12l5.5 6 1.1-1L7 12l4.6-5zm6 0l-1.1-1-5.5 6 5.5 6 1.1-1-4.6-5 4.6-5z"})}),Nn=window.wp.keycodes,In=window.wp.notices;function Dn(e){var t=e.onClose,n=e.onRemove,r=e.postId,o=(0,a.useSelect)(Ce.store).getLastEntityDeleteError,i=(0,a.useDispatch)(Ce.store).deleteEntityRecord,l=(0,a.useDispatch)(In.store).createErrorNotice,s=function(){t()},c=function(){var e=mn(hn().mark((function e(){var t,a;return hn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return J("trash_modal_move_to_trash_button_clicked"),e.next=3,i("postType","mailpoet_email",r,{},{throwOnError:!1});case 3:if(!e.sent){e.next=8;break}n(),e.next=17;break;case 8:if(410!==(null==(t=o("postType","mailpoet_email",r))?void 0:t.code)){e.next=13;break}n(),e.next=17;break;case 13:return a=null!=t&&t.message?t.message:(0,b.__)("An error occurred while moving the email to the trash.","mailpoet"),J("trash_modal_move_to_trash_error",{errorMessage:a}),e.next=17,l(a,{type:"snackbar",isDismissible:!0,context:"email-editor"});case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,h.jsxs)(D.Modal,{className:"mailpoet-move-to-trash-modal",title:(0,b.__)("Move to trash","mailpoet"),onRequestClose:function(){s(),J("trash_modal_closed")},focusOnMount:!0,children:[(0,h.jsx)("p",{children:(0,b.__)("Are you sure you want to move this email to trash?","mailpoet")}),(0,h.jsxs)("div",{className:"mailpoet-send-preview-modal-footer",children:[(0,h.jsx)(D.Button,{variant:"tertiary",onClick:function(){s(),J("trash_modal_cancel_button_clicked")},children:(0,b.__)("Cancel","mailpoet")}),(0,h.jsx)(D.Button,{variant:"primary",onClick:c,children:(0,b.__)("Move to trash","mailpoet")})]})]})}function Mn(){var e=N((0,l.useState)(!1),2),t=e[0],n=e[1],r=(0,a.useSelect)((function(e){return{urls:e(R).getUrls(),postId:e(R).getEmailPostId()}}),[]),o=r.urls,i=r.postId,s=N((0,Ce.useEntityProp)("postType","mailpoet_email","status"),2),c=s[0],u=s[1],d=(0,a.useDispatch)(R),p=d.saveEditedEmail,m=d.updateEmailMailPoetProperty;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(D.DropdownMenu,{className:"edit-site-more-menu",popoverProps:{className:"edit-site-more-menu__content"},icon:dn,label:(0,b.__)("More","mailpoet"),onToggle:function(e){return J("header_more_menu_dropdown_toggle",{isOpened:e})},children:function(e){var t=e.onClose;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(D.MenuGroup,{label:(0,b._x)("View","noun","mailpoet"),children:[(0,h.jsx)(Ue.PreferenceToggleMenuItem,{scope:"core",name:"fixedToolbar",label:(0,b.__)("Top toolbar","mailpoet"),info:(0,b.__)("Access all block and document tools in a single place","mailpoet"),messageActivated:(0,b.__)("Top toolbar activated","mailpoet"),messageDeactivated:(0,b.__)("Top toolbar deactivated","mailpoet"),onToggle:function(){return J("header_more_menu_fixed_toolbar_toggle")}}),(0,h.jsx)(Ue.PreferenceToggleMenuItem,{scope:"core",name:"focusMode",label:(0,b.__)("Spotlight mode","mailpoet"),info:(0,b.__)("Focus at one block at a time","mailpoet"),messageActivated:(0,b.__)("Spotlight mode activated","mailpoet"),messageDeactivated:(0,b.__)("Spotlight mode deactivated","mailpoet"),onToggle:function(){return J("header_more_menu_focus_mode_toggle")}}),(0,h.jsx)(Ue.PreferenceToggleMenuItem,{scope:R,name:"fullscreenMode",label:(0,b.__)("Fullscreen mode","mailpoet"),info:(0,b.__)("Work without distraction","mailpoet"),messageActivated:(0,b.__)("Fullscreen mode activated","mailpoet"),messageDeactivated:(0,b.__)("Fullscreen mode deactivated","mailpoet"),shortcut:Nn.displayShortcut.secondary("f"),onToggle:function(){return J("header_more_menu_fullscreen_mode_toggle")}})]}),(0,h.jsx)(D.MenuGroup,{children:"trash"===c?(0,h.jsx)(D.MenuItem,{onClick:mn(hn().mark((function e(){return hn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u("draft");case 2:return e.next=4,m("deleted_at","");case 4:return e.next=6,p();case 6:J("header_more_menu_restore_from_trash_button_clicked");case 7:case"end":return e.stop()}}),e)}))),children:(0,b.__)("Restore from trash","mailpoet")}):(0,h.jsx)(D.MenuItem,{onClick:function(){n(!0),J("header_more_menu_move_to_trash_button_clicked"),t()},isDestructive:!0,children:(0,b.__)("Move to trash","mailpoet")})})]})}}),t&&(0,h.jsx)(Dn,{onClose:function(){return n(!1)},onRemove:function(){window.location.href=o.listings},postId:i})]})}const An=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M15 4H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm.5 14c0 .3-.2.5-.5.5H9c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h6c.3 0 .5.2.5.5v12zm-4.5-.5h2V16h-2v1.5z"})}),Bn=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M20.5 16h-.7V8c0-1.1-.9-2-2-2H6.2c-1.1 0-2 .9-2 2v8h-.7c-.8 0-1.5.7-1.5 1.5h20c0-.8-.7-1.5-1.5-1.5zM5.7 8c0-.3.2-.5.5-.5h11.6c.3 0 .5.2.5.5v7.6H5.7V8z"})}),Ln=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M19.5 4.5h-7V6h4.44l-5.97 5.97 1.06 1.06L18 7.06v4.44h1.5v-7Zm-13 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-3H17v3a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h3V5.5h-3Z"})}),Rn=window.wp.url;var zn=function(e){return e.SUCCESS="success",e.ERROR="error",e}({}),Fn=(0,l.memo)((function(){var e=(0,l.useRef)(null),t=(0,a.useDispatch)(R),n=t.requestSendingNewsletterPreview,r=t.togglePreviewModal,o=t.updateSendPreviewEmail,i=(0,a.useSelect)((function(e){return e(R).getPreviewState()}),[]),s=i.toEmail,c=i.isSendingPreviewEmail,u=i.sendingPreviewStatus,d=i.isModalOpened,p=N((0,Ce.useEntityProp)("postType","mailpoet_email","mailpoet_data"),1)[0],m=function(){n(p.id,s)},f=function(){J("send_preview_email_modal_closed"),r(!1)};return(0,l.useEffect)((function(){var t;d&&(null===(t=e.current)||void 0===t||t.focus(),J("send_preview_email_modal_opened"))}),[d]),d?(0,h.jsxs)(D.Modal,{className:"mailpoet-send-preview-email",title:(0,b.__)("Send a test email","mailpoet"),onRequestClose:f,focusOnMount:!1,children:[u===zn.ERROR?(0,h.jsxs)("div",{className:"mailpoet-send-preview-modal-notice-error",children:[(0,b.__)("Sorry, we were unable to send this email.","mailpoet"),(0,h.jsxs)("ul",{children:[(0,h.jsx)("li",{children:(0,l.createInterpolateElement)((0,b.__)("Please check your <link>sending method configuration</link> with your hosting provider.","mailpoet"),{link:(0,h.jsx)("a",{href:"admin.php?page=mailpoet-settings#mta",target:"_blank",rel:"noopener noreferrer",onClick:function(){return J("send_preview_email_modal_check_sending_method_configuration_link_clicked")}})})}),(0,h.jsx)("li",{children:(0,l.createInterpolateElement)((0,b.__)("Or, sign up for MailPoet Sending Service to easily send emails. <link>Sign up for free</link>","mailpoet"),{link:(0,h.jsx)("a",{href:new URL("free-plan","https://www.mailpoet.com/").toString(),target:"_blank",rel:"noopener noreferrer",onClick:function(){return J("send_preview_email_modal_sign_up_for_mailpoet_sending_service_link_clicked")}},"sign-up-for-free")})})]})]}):null,(0,h.jsx)("p",{children:(0,l.createInterpolateElement)((0,b.__)("Send yourself a test email to test how your email would look like in different email apps. You can also test your spam score by sending a test email to <link1>{$serviceName}</link1>. <link2>Learn more</link2>.","mailpoet").replace("{$serviceName}","Mail Tester"),{link1:(0,h.jsx)("a",{href:"https://www.mail-tester.com/",target:"_blank",rel:"noopener noreferrer",onClick:function(){return J("send_preview_email_modal_send_test_email_to_mail_tester_link_clicked")}}),link2:(0,h.jsx)("a",{href:"https://kb.mailpoet.com/article/147-test-your-spam-score-with-mail-tester",target:"_blank",rel:"noopener noreferrer",onClick:function(){return J("send_preview_email_modal_learn_more_about_mail_tester_link_clicked")}})})}),(0,h.jsx)(D.TextControl,{label:(0,b.__)("Send to","mailpoet"),onChange:function(e){o(e),K("send_preview_email_modal_send_to_field_updated")},onKeyDown:function(e){e.keyCode===Nn.ENTER&&(e.preventDefault(),m(),J("send_preview_email_modal_send_to_field_key_code_enter"))},value:s,type:"email",ref:e,required:!0}),u===zn.SUCCESS?(0,h.jsxs)("p",{className:"mailpoet-send-preview-modal-notice-success",children:[(0,h.jsx)(Gt,{icon:Fe,style:{fill:"#4AB866"}}),(0,b.__)("Test email sent successfully!","mailpoet")]}):null,(0,h.jsxs)("div",{className:"mailpoet-send-preview-modal-footer",children:[(0,h.jsx)(D.Button,{variant:"tertiary",onClick:function(){J("send_preview_email_modal_close_button_clicked"),f()},children:(0,b.__)("Close","mailpoet")}),(0,h.jsx)(D.Button,{variant:"primary",onClick:function(){m(),J("send_preview_email_modal_send_test_email_button_clicked")},disabled:c||!(0,Rn.isEmail)(s),children:c?(0,b.__)("Sending","mailpoet"):(0,b.__)("Send test email","mailpoet")})]})]}):null}));function Vn(){var e=N((0,Ce.useEntityProp)("postType","mailpoet_email","mailpoet_data"),1)[0],t=(0,a.useSelect)((function(e){return e(R).getDeviceType()}),[]),n=(0,a.useDispatch)(R),r=n.changePreviewDeviceType,o=n.togglePreviewModal,i=(null==e?void 0:e.preview_url)||"",l=function(e){r(e)},s={mobile:An,desktop:Bn};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(D.DropdownMenu,{className:"mailpoet-preview-dropdown",label:(0,b.__)("Preview","mailpoet"),icon:s[t.toLowerCase()],onToggle:function(e){return J("header_preview_dropdown_clicked",{isOpened:e})},children:function(e){var n=e.onClose;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(D.MenuGroup,{children:[(0,h.jsx)(D.MenuItem,{className:"block-editor-post-preview__button-resize",onClick:function(){l("Desktop"),J("header_preview_dropdown_desktop_selected")},icon:"Desktop"===t&&Fe,children:(0,b.__)("Desktop","mailpoet")}),(0,h.jsx)(D.MenuItem,{className:"block-editor-post-preview__button-resize",onClick:function(){l("Mobile"),J("header_preview_dropdown_mobile_selected")},icon:"Mobile"===t&&Fe,children:(0,b.__)("Mobile","mailpoet")})]}),(0,h.jsx)(D.MenuGroup,{children:(0,h.jsx)(D.MenuItem,{className:"block-editor-post-preview__button-resize",onClick:function(){o(!0),J("header_preview_dropdown_send_test_email_selected"),n()},children:(0,b.__)("Send a test email","mailpoet")})}),i?(0,h.jsx)(D.MenuGroup,{children:(0,h.jsx)("div",{className:"edit-post-header-preview__grouping-external",children:(0,h.jsxs)(D.Button,{className:"edit-post-header-preview__button-external components-menu-item__button",onClick:function(){var e;J("header_preview_dropdown_preview_in_new_tab_selected"),e=i,window.open(e,"_blank","noreferrer")},children:[(0,b.__)("Preview in new tab","mailpoet"),(0,h.jsx)(Gt,{icon:Ln})]})})}):null]})}}),(0,h.jsx)(Fn,{})]})}const Hn=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M17.3 10.1c0-2.5-2.1-4.4-4.8-4.4-2.2 0-4.1 1.4-4.6 3.3h-.2C5.7 9 4 10.7 4 12.8c0 2.1 1.7 3.8 3.7 3.8h9c1.8 0 3.2-1.5 3.2-3.3.1-1.6-1.1-2.9-2.6-3.2zm-.5 5.1h-9c-1.2 0-2.2-1.1-2.2-2.3s1-2.4 2.2-2.4h1.3l.3-1.1c.4-1.3 1.7-2.2 3.2-2.2 1.8 0 3.3 1.3 3.3 2.9v1.3l1.3.2c.8.1 1.4.9 1.4 1.8-.1 1-.9 1.8-1.8 1.8z"})});function Gn(){var e=(0,a.useDispatch)(R).saveEditedEmail,t=(0,a.useSelect)((function(e){return{hasEdits:e(R).hasEdits(),isEmpty:e(R).isEmpty(),isSaving:e(R).isSaving()}}),[]),n=t.hasEdits,r=t.isEmpty,o=t.isSaving,i=!r&&!o&&!n,l=r||o||i,s=(0,b.__)("Save Draft","mailpoet");return i?s=(0,b.__)("Saved","mailpoet"):o&&(s=(0,b.__)("Saving","mailpoet")),(0,h.jsxs)(D.Button,{variant:"tertiary",disabled:l,onClick:function(){e(),J("header_save_email_button_clicked",{label:s,isSaving:o,isSaved:i})},children:[o&&(0,h.jsx)(Gt,{icon:Hn}),i&&(0,h.jsx)(Gt,{icon:Fe}),s]})}const Un=(0,h.jsx)(_e.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)(_e.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})});function Wn(){var e=(0,a.useSelect)((function(e){return{showIconLabels:e(R).isFeatureActive("showIconLabels"),postId:e(R).getEmailPostId()}}),[]).showIconLabels,t=N((0,Ce.useEntityProp)("postType","mailpoet_email","title"),2),n=t[0],r=void 0===n?"":n,o=t[1],i=(0,l.useRef)(null);return(0,h.jsx)("div",{ref:i,className:"mailpoet-email-editor-campaign-name",children:(0,h.jsx)(D.Dropdown,{popoverProps:{placement:"bottom",anchor:i.current},contentClassName:"mailpoet-email-editor-campaign-name__dropdown",renderToggle:function(t){var n=t.isOpen,o=t.onToggle;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(D.Button,{onClick:function(){o(),J("header_campaign_name_email_title_clicked",{isOpen:n})},className:"mailpoet-email-campaign-name__link",children:(0,h.jsxs)(D.__experimentalText,{size:"body",as:"h1",children:[(0,h.jsx)(D.VisuallyHidden,{as:"span",children:(0,b.__)("Editing email:","mailpoet")}),r]})}),(0,h.jsx)(D.Button,{className:"mailpoet-email-campaign-name__toggle",icon:Un,"aria-expanded":n,"aria-haspopup":"true",onClick:function(){o(),J("header_campaign_name_toggle_icon_clicked",{isOpen:n})},label:(0,b.__)("Change campaign name","mailpoet"),children:e&&(0,b.__)("Rename","mailpoet")})]})},renderContent:function(){return(0,h.jsx)("div",{className:"mailpoet-email-editor-email-title-edit",children:(0,h.jsx)(D.TextControl,{label:(0,b.__)("Campaign name","mailpoet"),value:r,onChange:function(e){o(e),K("header_campaign_name_title_updated")},name:"campaign_name",help:(0,b.__)("Name your email campaign to indicate its purpose. This would only be visible to you and not shown to your subscribers.","mailpoet")})})}})})}function $n(e){var t=e.validateContent,n=e.isContentInvalid,r=N((0,Ce.useEntityProp)("postType","mailpoet_email","mailpoet_data"),1)[0],o=(0,Te.useEntitiesSavedStatesIsDirty)().isDirty,i=(0,a.useSelect)((function(e){return{hasEmptyContent:e(R).hasEmptyContent(),isEmailSent:e(R).isEmailSent()}}),[]),l=i.hasEmptyContent,s=i.isEmailSent,c="template"===N(zt(),1)[0]||l||s||n||o,u=r;return(0,h.jsx)(D.Button,{variant:"primary",onClick:function(){J("header_send_button_clicked"),t()&&(window.location.href="admin.php?page=mailpoet-newsletters#/send/".concat(u.id))},disabled:c,children:(0,b.__)("Send","mailpoet")})}var qn=function(e){var t=e.onToggle;return(0,l.useEffect)((function(){document.querySelectorAll(".mailpoet-email-editor-save-button__dropdown  .components-panel__body").forEach((function(e){var t=e.querySelector(".components-panel__body-title button");if(t&&t.textContent.trim()===(0,b.__)("Templates","mailpoet")){var n=e.querySelectorAll(".components-panel__row");n.length&&(n[0].textContent=(0,b.__)("This change will affect emails that use this template.","mailpoet"))}}))}),[]),(0,h.jsx)(Te.EntitiesSavedStates,{close:t})};function Zn(){var e=(0,a.useSelect)((function(e){return{isSaving:e(R).isSaving()}}),[]).isSaving,t=(0,l.useRef)(null),n=(0,b.__)("Save","mailpoet");return e&&(n=(0,b.__)("Saving","mailpoet")),(0,h.jsx)("div",{ref:t,children:(0,h.jsx)(D.Dropdown,{popoverProps:{placement:"bottom",anchor:t.current},contentClassName:"mailpoet-email-editor-save-button__dropdown",renderToggle:function(t){var r=t.onToggle;return(0,h.jsx)(D.Button,{onClick:function(){J("header_save_all_button_save_button_clicked"),r()},variant:"primary",disabled:e,children:n})},renderContent:function(e){var t=e.onToggle;return(0,h.jsx)(qn,{onToggle:t})}})})}const Yn=window.wp.isShallowEqual;var Jn=n.n(Yn);function Kn(e){var t=(0,l.useRef)(e);return Jn()(e,t.current)||(t.current=e),t.current}var Xn=function(){var e="email-validation",t=(0,a.useSelect)((function(t){return t(In.store).getNotices(e)}));return{notices:t,hasValidationNotice:(0,l.useCallback)((function(e){return e?void 0!==t.find((function(t){return t.id===e})):(null==t?void 0:t.length)>0}),[t]),addValidationNotice:(0,l.useCallback)((function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];(0,a.dispatch)(In.store).createNotice("error",n,{id:t,isDismissible:!1,actions:r,context:e})}),[e]),removeValidationNotice:(0,l.useCallback)((function(t){(0,a.dispatch)(In.store).removeNotice(t,e)}),[e])}},Qn=D.ToolbarItem,er=f.BlockToolbar;function tr(){var e=(0,l.useRef)(),t=(0,l.useRef)(),n=(0,l.useRef)(),r=(0,l.useRef)(),o=N((0,l.useState)(!1),2),i=o[0],s=o[1],c=(0,a.useDispatch)(Ce.store),u=c.undo,d=c.redo,p=(0,a.useDispatch)(Te.store),m=p.setIsInserterOpened,_=p.setIsListViewOpened,g=(0,a.useSelect)((function(e){return{isInserterSidebarOpened:e(Te.store).isInserterOpened(),isListviewSidebarOpened:e(Te.store).isListViewOpened(),isFixedToolbarActive:e(Ue.store).get("core","fixedToolbar"),isBlockSelected:!!e(f.store).getBlockSelectionStart(),hasUndo:e(Ce.store).hasUndo(),hasRedo:e(Ce.store).hasRedo()}}),[]),v=g.isInserterSidebarOpened,y=g.isListviewSidebarOpened,x=g.isFixedToolbarActive,j=g.isBlockSelected,w=g.hasUndo,S=g.hasRedo,k=N(zt(),1)[0],O=function(){var e=(0,a.useSelect)((function(e){var t=e(f.store).getBlocks().filter((function(e){return"mailpoet/powered-by-mailpoet"!==e.name&&"core/post-content"!==e.name})),n=e(f.store).getBlocksByName("core/post-content");return{contentBlockId:null==n?void 0:n[0],hasFooter:t.length>0}})),t=e.contentBlockId,n=e.hasFooter,r=Xn(),o=r.addValidationNotice,i=r.hasValidationNotice,s=r.removeValidationNotice,c=(0,a.useSelect)((function(e){var t;return{editedContent:e(R).getEditedEmailContent(),editedTemplateContent:e(R).getCurrentTemplateContent(),postTemplateId:null===(t=e(R).getCurrentTemplate())||void 0===t?void 0:t.id}})),u=c.editedContent,d=c.editedTemplateContent,p=c.postTemplateId,m=Kn(u),_=Kn(d),h="<a data-link-href='[mailpoet/subscription-unsubscribe-url]' contenteditable='false' style='text-decoration: underline;' class='mailpoet-email-editor__personalization-tags-link'>".concat((0,b.__)("Unsubscribe","mailpoet"),"</a> | <a data-link-href='[mailpoet/subscription-manage-url]' contenteditable='false' style='text-decoration: underline;' class='mailpoet-email-editor__personalization-tags-link'>").concat((0,b.__)("Manage subscription","mailpoet"),"</a>"),g=(0,l.useMemo)((function(){var e=(0,fe.createBlock)("core/paragraph",{align:"center",fontSize:"small",content:h});return[{id:"missing-unsubscribe-link",test:function(e){return!e.includes("[mailpoet/subscription-unsubscribe-url]")},message:(0,b.__)('All emails must include an "Unsubscribe" link.',"mailpoet"),actions:[{label:(0,b.__)("Insert link","mailpoet"),onClick:function(){n?(0,a.dispatch)(Ce.store).editEntityRecord("postType","wp_template",p,{content:"\n                      ".concat(d,'\n                      \x3c!-- wp:paragraph {"align":"center","fontSize":"small"} --\x3e\n                      ').concat(h,"\n                      \x3c!-- /wp:paragraph --\x3e\n                    ")}):(0,a.dispatch)(f.store).insertBlock(e,void 0,t)}}]}]}),[t,n,h,p,d]),v=(0,l.useCallback)((function(){var e=!0;return g.forEach((function(t){var n=t.id,r=t.test,a=t.message,l=t.actions;r(m+_)?(o(n,a,l),e=!1):i(n)&&s(n)})),e}),[m,_,o,s,i,g]);return(0,a.subscribe)((function(){i()&&v()}),R),{isInvalid:i(),validateContent:v}}(),P=O.validateContent,E=O.isInvalid,T=(0,Te.useEntitiesSavedStatesIsDirty)().dirtyEntityRecords.some((function(e){return"mailpoet_email"!==e.name})),C=function(e){e.preventDefault()},I=v?(0,b.__)("Close","mailpoet"):(0,b.__)("Add","mailpoet");return(0,h.jsxs)("div",{className:"editor-header edit-post-header",children:[(0,h.jsxs)("div",{className:"editor-header__toolbar",children:[(0,h.jsx)(f.NavigableToolbar,{className:"editor-document-tools edit-post-header-toolbar is-unstyled","aria-label":(0,b.__)("Email document tools","mailpoet"),children:(0,h.jsxs)("div",{className:"editor-document-tools__left",children:[(0,h.jsx)(Qn,{ref:e,as:D.Button,className:"editor-header-toolbar__inserter-toggle edit-post-header-toolbar__inserter-toggle",variant:"primary",isPressed:v,onMouseDown:C,onClick:function(){return v?(J("header_inserter_sidebar_closed"),m(!1)):(J("header_inserter_sidebar_opened"),m(!0))},disabled:!1,icon:kn,label:I,showTooltip:!0,"aria-expanded":v}),(0,h.jsx)(Qn,{ref:n,as:D.Button,className:"editor-history__undo",isPressed:!1,onMouseDown:C,onClick:function(){u(),J("header_undo_icon_clicked")},disabled:!w,icon:On,label:(0,b.__)("Undo","mailpoet"),showTooltip:!0}),(0,h.jsx)(Qn,{ref:r,as:D.Button,className:"editor-history__redo",isPressed:!1,onMouseDown:C,onClick:function(){d(),J("header_redo_icon_clicked")},disabled:!S,icon:Pn,label:(0,b.__)("Redo","mailpoet"),showTooltip:!0}),(0,h.jsx)(Qn,{ref:t,as:D.Button,className:"editor-header-toolbar__document-overview-toggle edit-post-header-toolbar__document-overview-toggle",isPressed:y,onMouseDown:C,onClick:function(){return y?(J("header_listview_sidebar_closed"),_(!1)):(J("header_listview_sidebar_opened"),_(!0))},disabled:!1,icon:En,label:(0,b.__)("List view","mailpoet"),showTooltip:!0,"aria-expanded":v})]})}),x&&j&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:me()("editor-collapsible-block-toolbar",{"is-collapsed":i}),children:(0,h.jsx)(er,{hideDragHandle:!0})}),(0,h.jsx)(D.Button,{className:"editor-header__block-tools-toggle edit-post-header__block-tools-toggle",icon:i?Tn:Cn,onClick:function(){s((function(e){return!e})),J("header_blocks_tool_button_clicked",{isBlockToolsCollapsed:i})},label:i?(0,b.__)("Show block tools","mailpoet"):(0,b.__)("Hide block tools","mailpoet")})]})]}),(!x||!j||i)&&(0,h.jsx)("div",{className:"editor-header__center edit-post-header__center",children:"template"===k?(0,h.jsx)(Te.DocumentBar,{}):(0,h.jsx)(Wn,{})}),(0,h.jsxs)("div",{className:"editor-header__settings edit-post-header__settings",children:[(0,h.jsx)(Gn,{}),(0,h.jsx)(Vn,{}),T?(0,h.jsx)(Zn,{}):(0,h.jsx)($n,{validateContent:P,isContentInvalid:E}),(0,h.jsx)(jt.Slot,{scope:R}),(0,h.jsx)(Mn,{})]})]})}function nr(){return(0,h.jsx)("div",{className:"editor-list-view-sidebar",children:(0,h.jsx)(f.__experimentalListView,{})})}function rr(){var e=(0,a.useSelect)((function(e){var t;return{postContentId:null===(t=e(f.store).getBlocks().find((function(e){return"core/post-content"===e.name})))||void 0===t?void 0:t.clientId}})).postContentId,t=N(zt(),1)[0],n=(0,a.useDispatch)(Te.store).setIsInserterOpened;return(0,h.jsx)("div",{className:"editor-inserter-sidebar",children:(0,h.jsx)("div",{className:"editor-inserter-sidebar__content",children:(0,h.jsx)(f.__experimentalLibrary,{showMostUsedBlocks:!0,showInserterHelpPanel:!1,rootClientId:"email"===t?e:null,onClose:function(){n(!1),J("inserter_sidebar_library_close_icon_clicked",{editorMode:t})},onSelect:function(e){J("inserter_sidebar_library_block_selected",{editorMode:t,blockName:null==e?void 0:e.name})}})})})}function or(){var e=(0,a.useSelect)((function(e){return{isEmailSent:e(R).isEmailSent()}}),[]).isEmailSent;return(0,l.useEffect)((function(){e&&((0,a.dispatch)(In.store).createNotice("warning",(0,b.__)("This email has already been sent. It can be edited, but not sent again. Duplicate this email if you want to send it again.","mailpoet"),{id:"email-sent",isDismissible:!1,context:"email-editor"}),J("editor_showed_email_sent_notice"))}),[e]),null}function ir(){var e=Xn().notices;return 0===e.length?null:(0,h.jsx)(D.Notice,{status:"error",className:"mailpoet-email-editor-validation-errors components-editor-notices__pinned",isDismissible:!1,children:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("strong",{children:(0,b.__)("Fix errors to continue:","mailpoet")}),(0,h.jsx)("ul",{children:e.map((function(e){var t=e.id,n=e.content,r=e.actions;return(0,h.jsxs)("li",{children:[n,r.length>0?r.map((function(e){var t=e.label,n=e.onClick;return(0,h.jsx)(D.Button,{onClick:n,variant:"link",children:t},t)})):null]},t)}))})]})})}function ar(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ar(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ar(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function sr(e){var t=e.context,n=void 0===t?"email-editor":t,r=(0,a.useSelect)((function(e){return{notices:e(In.store).getNotices(n)}}),[n]).notices,o=(0,l.useMemo)((function(){return{"site-editor-save-success":{content:(0,b.__)("Email design updated.","mailpoet"),removeActions:!0}}}),[]),i=(0,a.useDispatch)(In.store).removeNotice,s=r.filter((function(e){return"snackbar"===e.type})).map((function(e){return o[e.id]?lr(lr({},e),{},{content:o[e.id].content,actions:o[e.id].removeActions?[]:e.actions}):e}));return(0,h.jsx)(D.SnackbarList,{notices:s,className:"components-editor-notices__snackbar",onRemove:function(e){return i(e,n)}})}function cr(){var e=(0,a.useSelect)((function(e){return{notices:e(In.store).getNotices("email-editor")}}),[]).notices,t=(0,a.useDispatch)(In.store).removeNotice,n=e.filter((function(e){var t=e.isDismissible,n=e.type;return t&&"default"===n})),r=e.filter((function(e){var t=e.isDismissible,n=e.type;return!t&&"default"===n}));return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(D.NoticeList,{notices:r,className:"components-editor-notices__pinned"}),(0,h.jsx)(D.NoticeList,{notices:n,className:"components-editor-notices__dismissible",onRemove:function(e){return t(e,"email-editor")}}),(0,h.jsx)(ir,{}),(0,h.jsx)(sr,{context:"global"}),(0,h.jsx)(sr,{context:"email-editor"})]})}const ur=(0,h.jsx)(_e.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)(_e.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M20 12a8 8 0 1 1-16 0 8 8 0 0 1 16 0Zm-1.5 0a6.5 6.5 0 0 1-6.5 6.5v-13a6.5 6.5 0 0 1 6.5 6.5Z"})}),dr=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M6.9 7L3 17.8h1.7l1-2.8h4.1l1 2.8h1.7L8.6 7H6.9zm-.7 6.6l1.5-4.3 1.5 4.3h-3zM21.6 17c-.1.1-.2.2-.3.2-.1.1-.2.1-.4.1s-.3-.1-.4-.2c-.1-.1-.1-.3-.1-.6V12c0-.5 0-1-.1-1.4-.1-.4-.3-.7-.5-1-.2-.2-.5-.4-.9-.5-.4 0-.8-.1-1.3-.1s-1 .1-1.4.2c-.4.1-.7.3-1 .4-.2.2-.4.3-.6.5-.1.2-.2.4-.2.7 0 .3.1.5.2.8.2.2.4.3.8.3.3 0 .6-.1.8-.3.2-.2.3-.4.3-.7 0-.3-.1-.5-.2-.7-.2-.2-.4-.3-.6-.4.2-.2.4-.3.7-.4.3-.1.6-.1.8-.1.3 0 .6 0 .8.1.2.1.4.3.5.5.1.2.2.5.2.9v1.1c0 .3-.1.5-.3.6-.2.2-.5.3-.9.4-.3.1-.7.3-1.1.4-.4.1-.8.3-1.1.5-.3.2-.6.4-.8.7-.2.3-.3.7-.3 1.2 0 .6.2 1.1.5 1.4.3.4.9.5 1.6.5.5 0 1-.1 1.4-.3.4-.2.8-.6 1.1-1.1 0 .4.1.7.3 1 .2.3.6.4 1.2.4.4 0 .7-.1.9-.2.2-.1.5-.3.7-.4h-.3zm-3-.9c-.2.4-.5.7-.8.8-.3.2-.6.2-.8.2-.4 0-.6-.1-.9-.3-.2-.2-.3-.6-.3-1.1 0-.5.1-.9.3-1.2s.5-.5.8-.7c.3-.2.7-.3 1-.5.3-.1.6-.3.7-.6v3.4z"})}),pr=(0,h.jsx)(_e.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)(_e.Path,{d:"M17.2 10.9c-.5-1-1.2-2.1-2.1-3.2-.6-.9-1.3-1.7-2.1-2.6L12 4l-1 1.1c-.6.9-1.3 1.7-2 2.6-.8 1.2-1.5 2.3-2 3.2-.6 1.2-1 2.2-1 3 0 3.4 2.7 6.1 6.1 6.1s6.1-2.7 6.1-6.1c0-.8-.3-1.8-1-3zm-5.1 7.6c-2.5 0-4.6-2.1-4.6-4.6 0-.3.1-1 .8-2.3.5-.9 1.1-1.9 2-3.1.7-.9 1.3-1.7 1.8-2.3.7.8 1.3 1.6 1.8 2.3.8 1.1 1.5 2.2 2 3.1.7 1.3.8 2 .8 2.3 0 2.5-2.1 4.6-4.6 4.6z"})});var mr={start:{scale:1,opacity:1},hover:{scale:0,opacity:0}},fr={hover:{opacity:1},start:{opacity:.5}},_r={hover:{scale:1,opacity:1},start:{scale:0,opacity:0}};function hr(e){var t,n,r,o,i=e.label,s=e.isFocused,c=e.withHoverView,u=(0,a.useSelect)((function(e){return{styles:e(R).getStyles(),colors:e(R).getPaletteColors()}}),[]),d=u.styles,p=u.colors,m=(null==d||null===(t=d.color)||void 0===t?void 0:t.background)||"#ffffff",f=(null==d||null===(n=d.elements)||void 0===n||null===(n=n.heading)||void 0===n||null===(n=n.typography)||void 0===n?void 0:n.fontFamily)||"inherit",_=(null==d||null===(r=d.elements)||void 0===r||null===(r=r.heading)||void 0===r||null===(r=r.color)||void 0===r?void 0:r.text)||"inherit",g=(null==d||null===(o=d.elements)||void 0===o||null===(o=o.heading)||void 0===o||null===(o=o.typography)||void 0===o?void 0:o.fontWeight)||"inherit",v=p.theme.concat(p.theme),y=v.filter((function(e){var t=e.color;return t.toLowerCase()!==m.toLowerCase()&&t.toLowerCase()!==_.toLowerCase()})).slice(0,2),b=N((0,l.useState)(!1),2),x=b[0],j=b[1];return(0,h.jsx)("div",{onMouseEnter:function(){return j(!0)},onMouseLeave:function(){return j(!1)},children:(0,h.jsxs)(D.__unstableMotion.div,{style:{height:152,width:"100%",background:m,cursor:c?"pointer":void 0},initial:"start",animate:(x||s)&&i?"hover":"start",children:[(0,h.jsx)(D.__unstableMotion.div,{variants:mr,style:{height:"100%",overflow:"hidden"},children:(0,h.jsxs)(D.__experimentalHStack,{spacing:10,justify:"center",style:{height:"100%",overflow:"hidden"},children:[(0,h.jsx)(D.__unstableMotion.div,{style:{fontFamily:f,fontSize:65,color:_,fontWeight:g},animate:{scale:1,opacity:1},initial:{scale:.1,opacity:0},transition:{delay:.3,type:"tween"},children:"Aa"}),(0,h.jsx)(D.__experimentalVStack,{spacing:4,children:y.map((function(e,t){var n=e.slug,r=e.color;return(0,h.jsx)(D.__unstableMotion.div,{style:{height:32,width:32,background:r,borderRadius:16},animate:{scale:1,opacity:1},initial:{scale:.1,opacity:0},transition:{delay:1===t?.2:.1}},n)}))})]})}),(0,h.jsx)(D.__unstableMotion.div,{variants:c&&fr,style:{height:"100%",width:"100%",position:"absolute",top:0,overflow:"hidden",filter:"blur(60px)",opacity:.1},children:(0,h.jsx)(D.__experimentalHStack,{spacing:0,justify:"flex-start",style:{height:"100%",overflow:"hidden"},children:v.slice(0,4).map((function(e){var t=e.color;return(0,h.jsx)("div",{style:{height:"100%",background:t,flexGrow:1}},t)}))})}),(0,h.jsx)(D.__unstableMotion.div,{variants:_r,style:{height:"100%",width:"100%",overflow:"hidden",position:"absolute",top:0},children:(0,h.jsx)(D.__experimentalVStack,{spacing:3,justify:"center",style:{height:"100%",overflow:"hidden",padding:10,boxSizing:"border-box"},children:i&&(0,h.jsx)("div",{style:{fontSize:40,fontFamily:f,color:_,fontWeight:g,lineHeight:"1em",textAlign:"center"},children:i})})})]})})}function gr(){return(0,h.jsx)(D.Card,{size:"small",className:"edit-site-global-styles-screen-root",variant:"primary",children:(0,h.jsx)(D.CardBody,{children:(0,h.jsxs)(D.__experimentalVStack,{spacing:4,children:[(0,h.jsx)(D.Card,{children:(0,h.jsx)(D.CardMedia,{children:(0,h.jsx)(hr,{})})}),(0,h.jsxs)(D.__experimentalItemGroup,{children:[(0,h.jsx)(D.__experimentalNavigatorButton,{path:"/typography",onClick:function(){return J("styles_sidebar_navigation_click",{path:"typography"})},children:(0,h.jsx)(D.__experimentalItem,{children:(0,h.jsxs)(D.__experimentalHStack,{justify:"flex-start",children:[(0,h.jsx)(D.Icon,{icon:dr,size:24}),(0,h.jsx)(D.FlexItem,{children:(0,b.__)("Typography","mailpoet")})]})})}),(0,h.jsx)(D.__experimentalNavigatorButton,{path:"/colors",onClick:function(){return J("styles_sidebar_navigation_click",{path:"colors"})},children:(0,h.jsx)(D.__experimentalItem,{children:(0,h.jsxs)(D.__experimentalHStack,{justify:"flex-start",children:[(0,h.jsx)(D.Icon,{icon:pr,size:24}),(0,h.jsx)(D.FlexItem,{children:(0,b.__)("Colors","mailpoet")})]})})}),(0,h.jsx)(D.__experimentalNavigatorButton,{path:"/layout",onClick:function(){return J("styles_sidebar_navigation_click",{path:"layout"})},children:(0,h.jsx)(D.__experimentalItem,{children:(0,h.jsxs)(D.__experimentalHStack,{justify:"flex-start",children:[(0,h.jsx)(D.Icon,{icon:un,size:24}),(0,h.jsx)(D.FlexItem,{children:(0,b.__)("Layout","mailpoet")})]})})})]})]})})})}function vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vr(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function br(e){var t=function(e){if("object"===u(e)&&null!==e||void 0===e){if(Array.isArray(e)&&0===e.length)return;for(var n in e)if(e.hasOwnProperty(n)){var r=t(e[n]);void 0===r?delete e[n]:e[n]=r}}return e};return t(e)}var xr=function(){var e=At(),t=e.userTheme,n=e.updateUserTheme,r=(0,l.useMemo)((function(){return br((e=null==t?void 0:t.styles,(n=function(e){if("object"===u(e)&&null!==e)for(var t in e)e.hasOwnProperty(t)&&(e[t]=n(e[t]));else if("string"==typeof e)return e.replace(/var\(--([a-z]+)--([a-z]+(?:--[a-z0-9]+(?:-[a-z0-9]+)*)*)--([a-z0-9-]+)\)/g,(function(e,t,n,r){var o=n.split("--").concat(r);return"var:".concat(o.join("|"))}));return e})(e)));var e,n}),[t]),o=(0,a.useSelect)((function(e){return{styles:e(R).getStyles()}})).styles,i=(0,l.useCallback)((function(e){var r=yr(yr({},t),{},{styles:br(e)});n(r)}),[n,t]),s=(0,l.useCallback)((function(e,r){var o=function(e,t,n){var r=Array.isArray(t)?Be(t):[t],o=Array.isArray(e)?Be(e):yr({},e),i=r.pop(),a=o;return r.forEach((function(e){var t=a[e];a[e]=Array.isArray(t)?Be(t):yr({},t),a=a[e]})),a[i]=n,o}(t,["styles"].concat(Be(e)),r);n(o)}),[n,t]);return{styles:Mt().all([o||{},r||{}]),userStyles:null==t?void 0:t.styles,defaultStyles:o,updateStyleProp:s,updateStyles:i}};function jr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jr(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Sr={typography:{},color:{}},kr=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"heading",r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];switch(t){case"text":return{typography:e.typography,color:e.color};case"heading":return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"heading";return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?Mt().all([Sr,e.elements.heading||{},e.elements[t]||{}]):wr(wr(wr({},Sr),e.elements.heading||{}),e.elements[t]||{})}(e,null!=n?n:"heading",r);default:return e.elements[t]||Sr}};function Or(e){var t,n,r=e.element,o=e.label,i=xr().styles,a=kr(i,r,null,!0),l=a.typography,s=l.fontFamily,c=l.fontStyle,u=l.fontWeight,d=l.letterSpacing,p=l.textDecoration,m=l.textTransform,f=(null===(t=a.color)||void 0===t?void 0:t.text)||"inherit",_=(null===(n=a.color)||void 0===n?void 0:n.background)||"#f0f0f0",g=(0,b.sprintf)(
// translators: %s: is a subset of Typography, e.g., 'text' or 'links'.
// translators: %s: is a subset of Typography, e.g., 'text' or 'links'.
(0,b.__)("Typography %s styles","mailpoet"),o);return(0,h.jsx)(D.__experimentalItem,{children:(0,h.jsx)(D.__experimentalNavigatorButton,{path:"/typography/".concat(r),"aria-label":g,onClick:function(){return J("styles_sidebar_screen_typography_button_click",{element:r,label:o,path:"typography/".concat(r)})},children:(0,h.jsxs)(D.__experimentalHStack,{justify:"flex-start",children:[(0,h.jsx)(D.FlexItem,{className:"edit-site-global-styles-screen-typography__indicator",style:{fontFamily:null!=s?s:"serif",background:_,color:f,fontStyle:null!=c?c:"normal",fontWeight:null!=u?u:"normal",letterSpacing:null!=d?d:"normal",textDecoration:null!=p?p:"link"===r?"underline":"none",textTransform:null!=m?m:"none"},children:"Aa"}),(0,h.jsx)(D.FlexItem,{children:o})]})})})}const Pr=function(){return(0,h.jsx)(D.Card,{size:"small",variant:"primary",isBorderless:!0,children:(0,h.jsx)(D.CardBody,{children:(0,h.jsxs)(D.__experimentalVStack,{spacing:3,children:[(0,h.jsx)(D.__experimentalHeading,{level:3,className:"edit-site-global-styles-subtitle",children:(0,b.__)("Elements","mailpoet")}),(0,h.jsxs)(D.__experimentalItemGroup,{isBordered:!0,isSeparated:!0,size:"small",children:[(0,h.jsx)(Or,{element:"text",label:(0,b.__)("Text","mailpoet")}),(0,h.jsx)(Or,{element:"link",label:(0,b.__)("Links","mailpoet")}),(0,h.jsx)(Or,{element:"heading",label:(0,b.__)("Headings","mailpoet")}),(0,h.jsx)(Or,{element:"button",label:(0,b.__)("Buttons","mailpoet")})]})]})})})},Er=(0,h.jsx)(_e.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(_e.Path,{d:"M14.6 7l-1.2-1L8 12l5.4 6 1.2-1-4.6-5z"})});function Tr(e){var t=e.title,n=e.description,r=e.onBack;return(0,h.jsxs)(D.__experimentalVStack,{spacing:0,children:[(0,h.jsx)(D.__experimentalView,{children:(0,h.jsx)(D.__experimentalSpacer,{marginBottom:0,paddingX:4,paddingY:3,children:(0,h.jsxs)(D.__experimentalHStack,{spacing:2,children:[(0,h.jsx)(D.__experimentalNavigatorToParentButton,{style:{minWidth:24,padding:0},icon:Er,size:"small","aria-label":(0,b.__)("Navigate to the previous view","mailpoet"),onClick:r}),(0,h.jsx)(D.__experimentalSpacer,{children:(0,h.jsx)(D.__experimentalHeading,{className:"mailpoet-email-editor__styles-header",level:2,size:13,children:t})})]})})}),n&&(0,h.jsx)("p",{className:"mailpoet-email-editor__styles-header-description",children:n})]})}const Cr=Tr;function Nr(){return K("styles_sidebar_screen_typography_opened"),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Cr,{title:(0,b.__)("Typography","mailpoet"),description:(0,b.__)("Manage the typography settings for different elements.","mailpoet")}),(0,h.jsx)(Pr,{})]})}var Ir={fontFamily:!0,fontSize:!0,fontAppearance:!0,lineHeight:!0,letterSpacing:!1,textTransform:!1,textDecoration:!1,writingMode:!0,textColumns:!0};const Dr=function(e){var t=e.element,n=e.headingLevel,r=e.defaultControls,o=void 0===r?Ir:r,i=N((0,f.useSettings)("typography.fontSizes","typography.fontFamilies"),2),a=i[0],s=i[1],c=(null==s?void 0:s.default)||[],u=xr(),d=u.styles,p=u.defaultStyles,m=u.updateStyleProp,_=kr(d,t,n),g=kr(p,t,n),v=_.typography,y=v.fontFamily,x=v.fontSize,j=v.fontStyle,w=v.fontWeight,S=v.lineHeight,k=v.letterSpacing,O=v.textDecoration,P=v.textTransform,E=g.typography,T=E.fontFamily,C=E.fontSize,I=E.fontStyle,M=E.fontWeight,A=E.lineHeight,B=E.letterSpacing,L=E.textDecoration,R=E.textTransform,z="heading"!==t||"heading"!==n,F=(0,l.useCallback)((function(e,r){m("heading"===t?["elements",n].concat(Be(e)):"text"===t?Be(e):["elements",t].concat(Be(e)),r)}),[t,m,n]),V=function(e){F(["typography","letterSpacing"],e),X("styles_sidebar_screen_typography_element_panel_set_letter_spacing",{element:t,newValue:e,selectedDefaultLetterSpacing:e===B})},H=function(e){F(["typography","lineHeight"],e),X("styles_sidebar_screen_typography_element_panel_set_line_height",{element:t,newValue:e,selectedDefaultLineHeight:e===A})},G=function(e){F(["typography","fontSize"],e),X("styles_sidebar_screen_typography_element_panel_set_font_size",{element:t,headingLevel:n,newValue:e,selectedDefaultFontSize:e===C})},U=function(e){F(["typography","fontFamily"],e),X("styles_sidebar_screen_typography_element_panel_set_font_family",{element:t,newValue:e,selectedDefaultFontFamily:e===T})},W=function(e){F(["typography","textDecoration"],e),X("styles_sidebar_screen_typography_element_panel_set_text_decoration",{element:t,newValue:e,selectedDefaultTextDecoration:e===L})},$=function(e){F(["typography","textTransform"],e),X("styles_sidebar_screen_typography_element_panel_set_text_transform",{element:t,newValue:e,selectedDefaultTextTransform:e===R})},q=function(e){var n=e.fontStyle,r=e.fontWeight;F(["typography","fontStyle"],n),F(["typography","fontWeight"],r),X("styles_sidebar_screen_typography_element_panel_set_font_appearance",{element:t,newFontStyle:n,newFontWeight:r,selectedDefaultFontStyle:n===I,selectedDefaultFontWeight:r===M})};return(0,h.jsxs)(D.__experimentalToolsPanel,{label:(0,b.__)("Typography","mailpoet"),resetAll:function(){F(["typography"],g.typography),J("styles_sidebar_screen_typography_element_panel_reset_all_styles_selected",{element:t,headingLevel:n})},children:[(0,h.jsx)(D.__experimentalToolsPanelItem,{label:(0,b.__)("Font family","mailpoet"),hasValue:function(){return y!==T},onDeselect:function(){return U(T)},isShownByDefault:o.fontFamily,children:(0,h.jsx)(f.__experimentalFontFamilyControl,{value:y,onChange:U,size:"__unstable-large",fontFamilies:c,__nextHasNoMarginBottom:!0})}),z&&(0,h.jsx)(D.__experimentalToolsPanelItem,{label:(0,b.__)("Font size","mailpoet"),hasValue:function(){return x!==C},onDeselect:function(){return G(C)},isShownByDefault:o.fontSize,children:(0,h.jsx)(D.FontSizePicker,{value:x,onChange:G,fontSizes:a,disableCustomFontSizes:!1,withReset:!1,withSlider:!0,size:"__unstable-large",__nextHasNoMarginBottom:!0})}),(0,h.jsx)(D.__experimentalToolsPanelItem,{className:"single-column",label:(0,b.__)("Appearance","mailpoet"),hasValue:function(){return w!==M||j!==I},onDeselect:function(){q({fontStyle:I,fontWeight:M})},isShownByDefault:o.fontAppearance,children:(0,h.jsx)(f.__experimentalFontAppearanceControl,{value:{fontStyle:j,fontWeight:w},onChange:q,hasFontStyles:!0,hasFontWeights:!0,size:"__unstable-large"})}),(0,h.jsx)(D.__experimentalToolsPanelItem,{className:"single-column",label:(0,b.__)("Line height","mailpoet"),hasValue:function(){return S!==A},onDeselect:function(){return H(A)},isShownByDefault:o.lineHeight,children:(0,h.jsx)(f.LineHeightControl,{__nextHasNoMarginBottom:!0,__unstableInputWidth:"auto",value:S,onChange:H,size:"__unstable-large"})}),(0,h.jsx)(D.__experimentalToolsPanelItem,{className:"single-column",label:(0,b.__)("Letter spacing","mailpoet"),hasValue:function(){return k!==B},onDeselect:function(){return V(B)},isShownByDefault:o.letterSpacing,children:(0,h.jsx)(f.__experimentalLetterSpacingControl,{value:k,onChange:V,size:"__unstable-large",__unstableInputWidth:"auto"})}),(0,h.jsx)(D.__experimentalToolsPanelItem,{className:"single-column",label:(0,b.__)("Text decoration","mailpoet"),hasValue:function(){return O!==L},onDeselect:function(){return W(L)},isShownByDefault:o.textDecoration,children:(0,h.jsx)(f.__experimentalTextDecorationControl,{value:O,onChange:W,size:"__unstable-large",__unstableInputWidth:"auto"})}),(0,h.jsx)(D.__experimentalToolsPanelItem,{label:(0,b.__)("Letter case","mailpoet"),hasValue:function(){return P!==R},onDeselect:function(){return $(R)},isShownByDefault:o.textTransform,children:(0,h.jsx)(f.__experimentalTextTransformControl,{value:P,onChange:$,showNone:!0,isBlock:!0,size:"__unstable-large",__nextHasNoMarginBottom:!0})})]})};function Mr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ar(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mr(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Br(e){var t,n,r=e.element,o=e.headingLevel,i=xr().styles,a=kr(i,r,o,!0),l=a.typography,s=l.fontFamily,c=l.fontSize,u=l.fontStyle,d=l.fontWeight,p=l.lineHeight,m=l.letterSpacing,f=l.textDecoration,_=l.textTransform,g=(null===(t=a.color)||void 0===t?void 0:t.text)||"inherit",v=(null===(n=a.color)||void 0===n?void 0:n.background)||"#f0f0f0",y="link"===r?{textDecoration:null!=f?f:"underline"}:{};return(0,h.jsx)("div",{className:"edit-site-typography-preview",style:Ar({fontFamily:null!=s?s:"serif",background:v,color:g,lineHeight:p,fontSize:c,fontStyle:u,fontWeight:d,letterSpacing:m,textDecoration:f,textTransform:_},y),children:"Aa"})}function Lr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lr(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zr={text:{title:(0,b.__)("Text","mailpoet"),description:(0,b.__)("Manage the fonts and typography used on text.","mailpoet"),defaultControls:Ir},link:{title:(0,b.__)("Links","mailpoet"),description:(0,b.__)("Manage the fonts and typography used on links.","mailpoet"),defaultControls:Rr(Rr({},Ir),{},{textDecoration:!0})},heading:{title:(0,b.__)("Headings","mailpoet"),description:(0,b.__)("Manage the fonts and typography used on headings.","mailpoet"),defaultControls:Rr(Rr({},Ir),{},{textTransform:!0})},button:{title:(0,b.__)("Buttons","mailpoet"),description:(0,b.__)("Manage the fonts and typography used on buttons.","mailpoet"),defaultControls:Ir}};function Fr(e){var t=e.element;K("styles_sidebar_screen_typography_element_opened",{element:t});var n=N((0,l.useState)("heading"),2),r=n[0],o=n[1];return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Cr,{title:zr[t].title,description:zr[t].description}),(0,h.jsx)(D.__experimentalSpacer,{marginX:4,children:(0,h.jsx)(Br,{element:t,headingLevel:r})}),"heading"===t&&(0,h.jsx)(D.__experimentalSpacer,{marginX:4,marginBottom:"1em",children:(0,h.jsxs)(D.__experimentalToggleGroupControl,{label:(0,b.__)("Select heading level","mailpoet"),hideLabelFromVision:!0,value:r,onChange:function(e){o(e.toString()),J("styles_sidebar_screen_typography_element_heading_level_selected",{value:e})},isBlock:!0,size:"__unstable-large",__nextHasNoMarginBottom:!0,children:[(0,h.jsx)(D.__experimentalToggleGroupControlOption,{value:"heading",label:(0,b._x)("All","heading levels","mailpoet")}),(0,h.jsx)(D.__experimentalToggleGroupControlOption,{value:"h1",label:(0,b._x)("H1","Heading Level","mailpoet")}),(0,h.jsx)(D.__experimentalToggleGroupControlOption,{value:"h2",label:(0,b._x)("H2","Heading Level","mailpoet")}),(0,h.jsx)(D.__experimentalToggleGroupControlOption,{value:"h3",label:(0,b._x)("H3","Heading Level","mailpoet")}),(0,h.jsx)(D.__experimentalToggleGroupControlOption,{value:"h4",label:(0,b._x)("H4","Heading Level","mailpoet")}),(0,h.jsx)(D.__experimentalToggleGroupControlOption,{value:"h5",label:(0,b._x)("H5","Heading Level","mailpoet")}),(0,h.jsx)(D.__experimentalToggleGroupControlOption,{value:"h6",label:(0,b._x)("H6","Heading Level","mailpoet")})]})}),(0,h.jsx)(Dr,{element:t,headingLevel:r,defaultControls:zr[t].defaultControls})]})}function Vr(){K("styles_sidebar_screen_colors_opened");var e=xr(),t=e.userStyles,n=e.styles,r=e.updateStyles,o=(0,a.useSelect)((function(e){return e(R).getTheme()}),[]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Cr,{title:(0,b.__)("Colors","mailpoet"),description:(0,b.__)("Manage palettes and the default color of different global elements.","mailpoet")}),(0,h.jsx)(Me,{value:t,inheritedValue:n,onChange:function(e){r(e),J("styles_sidebar_screen_colors_styles_updated")},settings:null==o?void 0:o.settings,panelId:"colors"})]})}function Hr(){var e=N((0,f.useSettings)("spacing.units"),1)[0],t=(0,D.__experimentalUseCustomUnits)({availableUnits:e}),n=xr(),r=n.styles,o=n.defaultStyles,i=n.updateStyleProp;return(0,h.jsxs)(D.__experimentalToolsPanel,{label:(0,b.__)("Dimensions","mailpoet"),resetAll:function(){i(["spacing"],o.spacing),J("styles_sidebar_screen_layout_dimensions_reset_all_selected")},children:[(0,h.jsx)(D.__experimentalToolsPanelItem,{isShownByDefault:!0,hasValue:function(){return!(0,U.isEqual)(r.spacing.padding,o.spacing.padding)},label:(0,b.__)("Padding","mailpoet"),onDeselect:function(){i(["spacing","padding"],o.spacing.padding),J("styles_sidebar_screen_layout_dimensions_padding_reset_clicked")},className:"tools-panel-item-spacing",children:(0,h.jsx)(f.__experimentalSpacingSizesControl,{allowReset:!0,values:r.spacing.padding,onChange:function(e){i(["spacing","padding"],e),X("styles_sidebar_screen_layout_dimensions_padding_updated",{value:e})},label:(0,b.__)("Padding","mailpoet"),sides:["horizontal","vertical","top","left","right","bottom"],units:t})}),(0,h.jsx)(D.__experimentalToolsPanelItem,{isShownByDefault:!0,label:(0,b.__)("Block spacing","mailpoet"),hasValue:function(){return r.spacing.blockGap!==o.spacing.blockGap},onDeselect:function(){i(["spacing","blockGap"],o.spacing.blockGap),J("styles_sidebar_screen_layout_dimensions_block_spacing_reset_clicked")},className:"tools-panel-item-spacing",children:(0,h.jsx)(f.__experimentalSpacingSizesControl,{label:(0,b.__)("Block spacing","mailpoet"),min:0,onChange:function(e){i(["spacing","blockGap"],e.top),X("styles_sidebar_screen_layout_dimensions_block_spacing_updated",{value:e})},showSideInLabel:!1,sides:["top"],values:{top:r.spacing.blockGap},allowReset:!0})})]})}function Gr(){return K("styles_sidebar_screen_layout_opened"),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Tr,{title:(0,b.__)("Layout","mailpoet")}),(0,h.jsx)(Hr,{})]})}function Ur(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ur(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ur(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $r=(0,l.memo)((function(e){return(0,h.jsx)(Ot,Wr(Wr({identifier:"email-editor/editor/styles",className:"mailpoet-email-editor__styles-panel",header:(0,b.__)("Styles","mailpoet"),closeLabel:(0,b.__)("Close styles sidebar","mailpoet"),icon:ur,scope:R,smallScreenTitle:(0,b.__)("No title","mailpoet")},e),{},{children:(0,h.jsxs)(D.__experimentalNavigatorProvider,{initialPath:"/",children:[(0,h.jsx)(D.__experimentalNavigatorScreen,{path:"/",children:(0,h.jsx)(gr,{})}),(0,h.jsx)(D.__experimentalNavigatorScreen,{path:"/typography",children:(0,h.jsx)(Nr,{})}),(0,h.jsx)(D.__experimentalNavigatorScreen,{path:"/typography/text",children:(0,h.jsx)(Fr,{element:"text"})}),(0,h.jsx)(D.__experimentalNavigatorScreen,{path:"/typography/link",children:(0,h.jsx)(Fr,{element:"link"})}),(0,h.jsx)(D.__experimentalNavigatorScreen,{path:"/typography/heading",children:(0,h.jsx)(Fr,{element:"heading"})}),(0,h.jsx)(D.__experimentalNavigatorScreen,{path:"/typography/button",children:(0,h.jsx)(Fr,{element:"button"})}),(0,h.jsx)(D.__experimentalNavigatorScreen,{path:"/colors",children:(0,h.jsx)(Vr,{})}),(0,h.jsx)(D.__experimentalNavigatorScreen,{path:"/layout",children:(0,h.jsx)(Gr,{})})]})}))}));function qr(e){var t=e.contentRef,n=(0,a.useSelect)((function(e){var t=e(Te.store),n=t.getEditorSettings,r=t.getCurrentTemplateId;return{onNavigateToEntityRecord:n().onNavigateToEntityRecord,templateId:r()}}),[]),r=n.onNavigateToEntityRecord,o=n.templateId,i=N((0,l.useState)(!1),2),s=i[0],c=i[1];return(0,l.useEffect)((function(){var e=function(e){e.target.classList.contains("is-root-container")&&(c(!0),K("edit_template_blocks_notification_opened"))},n=t.current;return null==n||n.addEventListener("dblclick",e),function(){null==n||n.removeEventListener("dblclick",e)}}),[t]),(0,h.jsx)(D.__experimentalConfirmDialog,{isOpen:s,confirmButtonText:(0,b.__)("Edit template"),onConfirm:function(){c(!1),r({postId:o,postType:"wp_template"}),J("edit_template_blocks_notification_edit_template_button_clicked",{templateId:o})},onCancel:function(){c(!1),J("edit_template_blocks_notification_cancel_button_clicked",{templateId:o})},size:"medium",children:(0,b.__)("The block youve selected is part of a template that might be used in other emails. Are you sure you want to edit the template?","mailpoet")})}function Zr(e,t,n){return Math.min(Math.max(e,t),n)}function Yr(){var e,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).isEnabled,n=void 0===t||t,r=(e=(0,a.useSelect)(f.store),Ne(e).getEnabledClientIdsTree),o=(0,a.useSelect)(f.store),i=o.getBlockName,l=o.getBlockOrder,s=(0,a.useDispatch)(f.store).selectBlock;return(0,_.useRefEffect)((function(e){if(!n)return null;var t=function(t){var n,o,a,c;(t.target===e||t.target.classList.contains("is-root-container"))&&(n=t.clientX,o=t.clientY,a=r().flatMap((function(e){var t=e.clientId,n=i(t);if("core/template-part"===n)return[];if("core/post-content"===n){var r=l(t);if(r.length)return r}return[t]})).reduce((function(t,r){var i=e.querySelector('[data-block="'.concat(r,'"]'));if(!i)return t;var a=i.getBoundingClientRect(),l=function(e,t,n){var r=e-Zr(e,Number(n.left),Number(n.right)),o=t-Zr(t,Number(n.top),Number(n.bottom));return Math.sqrt(r*r+o*o)}(Number(n),Number(o),a);return l<t.distance&&l<500?{clientId:r,distance:l}:t}),{clientId:null,distance:Number.POSITIVE_INFINITY}),(c=(null==a?void 0:a.clientId)||"")&&s(c))};return e.addEventListener("click",t),function(){return e.removeEventListener("click",t)}}),[n])}function Jr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jr(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Xr="wp_block",Qr=[Xr,"wp_template","wp_navigation","wp_template_part"];function eo(e){var t,n,r=e.styles,o=e.disableIframe,i=void 0!==o&&o,s=e.iframeProps,c=e.contentRef,u=e.className,d=(0,a.useSelect)((function(e){var t,n=e(Te.store),r=n.getCurrentPostId,o=n.getCurrentPostType,i=n.getEditorSettings,a=n.getRenderingMode,l=n.getDeviceType,s=o(),c=a();s===Xr?t="core/block":"post-only"===c&&(t="core/post-content");var u=i();return{renderingMode:c,isDesignPostType:Qr.includes(s),wrapperBlockName:t,wrapperUniqueId:r(),deviceType:l(),isFocusedEntity:!!u.onNavigateToPreviousEntityRecord,postType:s,isPreview:u.__unstableIsPreviewMode,layout:u.__experimentalFeatures.layout}}),[]),p=d.renderingMode,m=d.wrapperBlockName,g=d.wrapperUniqueId,v=d.deviceType,y=d.isFocusedEntity,b=d.layout,x=(0,f.__experimentalUseResizeCanvas)(v),j=b,w=(0,l.useRef)(),S=(0,f.__unstableUseTypewriter)(),k=(0,_.useMergeRefs)([w,c,"post-only"===p?S:null,Yr({isEnabled:"template-locked"===p})]),O=!i||["Tablet","Mobile"].includes(v),P="Desktop"===v?b.contentSize:"100%",E=[].concat(Be(null!==(t=r)&&void 0!==t?t:[]),[{css:".is-root-container{display:flow-root; width:".concat(P,"; margin: 0 auto;box-sizing: border-box;}")}]);return(0,h.jsx)("div",{className:me()("editor-visual-editor","edit-post-visual-editor",u,{"has-padding":y,"is-iframed":O}),children:(0,h.jsx)(Ie,{shouldIframe:O,contentRef:k,styles:E,height:"100%",iframeProps:Kr(Kr({},s),{},{style:Kr(Kr({},null==s?void 0:s.style),x)}),children:(0,h.jsxs)(f.RecursionProvider,{blockName:m,uniqueId:g,children:[(0,h.jsx)(f.BlockList,{className:me()("is-".concat(v.toLowerCase(),"-preview"),"has-global-padding"),layout:j,dropZoneElement:i?w.current:null===(n=w.current)||void 0===n?void 0:n.parentNode,__unstableDisableDropZone:"template-locked"===p}),"template-locked"===p&&(0,h.jsx)(qr,{contentRef:w})]})})})}function to(){var e=N((0,l.useState)(!1),2),t=e[0],n=e[1],r=(0,a.useSelect)((function(e){return{emailContentIsEmpty:e(R).hasEmptyContent(),emailHasEdits:e(R).hasEdits()}}),[]),o=r.emailContentIsEmpty,i=r.emailHasEdits;return!o||i||t?null:(0,h.jsx)(ln,{onSelectCallback:function(){return n(!0)}})}function no(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ro(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?no(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):no(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oo(){K("editor_layout_loaded");var e=(0,a.useSelect)((function(e){return{isFullscreenActive:e(R).isFeatureActive("fullscreenMode"),isSidebarOpened:e(R).isSidebarOpened(),isInserterSidebarOpened:e(Te.store).isInserterOpened(),isListviewSidebarOpened:e(Te.store).isListViewOpened(),initialSettings:e(R).getInitialEditorSettings(),previewDeviceType:e(R).getDeviceType(),canUserEditMedia:e(Ce.store).canUser("create","media"),hasFixedToolbar:e(R).isFeatureActive("fixedToolbar"),focusMode:e(R).isFeatureActive("focusMode"),styles:e(R).getStyles()}}),[]),t=e.isFullscreenActive,n=e.isSidebarOpened,r=e.initialSettings,o=e.previewDeviceType,i=e.isInserterSidebarOpened,s=e.isListviewSidebarOpened,c=e.canUserEditMedia,u=e.hasFixedToolbar,d=e.focusMode,p=e.styles,m=(0,a.useDispatch)(Te.store).setIsInserterOpened,_=N(Bt(),1)[0],g=me()("edit-post-layout",{"is-sidebar-opened":n}),v=(0,l.useRef)(null),y={background:"Desktop"===o?p.color.background:"transparent",fontFamily:p.typography.fontFamily,transition:"all 0.3s ease 0s"},b=ro(ro({},r),{},{mediaUpload:c?Le.uploadMedia:null,hasFixedToolbar:u,focusMode:d});return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Pt,{isActive:t}),(0,h.jsx)(Te.UnsavedChangesWarning,{}),(0,h.jsx)(Lt,{}),(0,h.jsx)(or,{}),(0,h.jsx)(wn,{}),(0,h.jsx)($r,{}),(0,h.jsx)(to,{}),(0,h.jsx)(It,{className:g,header:(0,h.jsx)(tr,{}),editorNotices:(0,h.jsx)(cr,{}),content:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(cr,{}),(0,h.jsx)(f.BlockSelectionClearer,{className:"edit-post-visual-editor",style:y,onClick:function(){i&&m(!1)},children:(0,h.jsx)("div",{className:"visual-editor__email_content_wrapper",children:(0,h.jsx)(eo,{disableIframe:!1,styles:[].concat(Be(b.styles),Be(_)),className:"has-global-padding",contentRef:v,iframeProps:{}})})})]}),sidebar:(0,h.jsx)(Ot.Slot,{scope:R}),secondarySidebar:i&&(0,h.jsx)(rr,{})||s&&(0,h.jsx)(nr,{})}),(0,h.jsx)(Sn,{})]})}var io=["postId","postType","settings","initialEdits"];function ao(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ao(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ao(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function so(e){var t=e.postId,n=e.postType,r=e.settings,o=e.initialEdits,i=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,io),s=function(e,t,n){var r=(0,l.useReducer)((function(e,t){var n=t.type,r=t.post,o=t.previousRenderingMode;return"push"===n?[].concat(Be(e),[{post:r,previousRenderingMode:o}]):"pop"===n&&e.length>1?e.slice(0,-1):e}),[{post:{postId:e,postType:t}}]),o=N(r,2),i=o[0],s=o[1],c=i[i.length-1],u=c.post,d=c.previousRenderingMode,p=(0,a.useSelect)(Te.store).getRenderingMode,m=(0,a.useDispatch)(Te.store).setRenderingMode,f=(0,l.useCallback)((function(e){s({type:"push",post:{postId:e.postId,postType:e.postType},previousRenderingMode:p()}),m(n)}),[p,m,n]),_=(0,l.useCallback)((function(){s({type:"pop"}),d&&m(d)}),[m,d]);return{currentPost:u,onNavigateToEntityRecord:f,onNavigateToPreviousEntityRecord:i.length>1?_:void 0}}(t,n,"post-only"),c=s.currentPost,u=s.onNavigateToEntityRecord,d=s.onNavigateToPreviousEntityRecord,p=(0,a.useSelect)((function(e){var t=e(Ce.store).getEntityRecord,n=e(R).getEditedPostTemplate,r=t("postType",c.postType,c.postId);return{template:"wp_template"!==c.postType?n():null,post:r}}),[c.postType,c.postId]),m=p.post,f=p.template,_=(0,a.useSelect)((function(e){var t=function(e){var t=Ne(e(Ce.store));return{hasFinishedResolution:t.hasFinishedResolution,getBlockPatternsForPostType:t.getBlockPatternsForPostType}}(e),n=t.hasFinishedResolution,r=(0,t.getBlockPatternsForPostType)(c.postType);return n("getBlockPatterns")?r:void 0}),[c.postType]),g=(0,l.useMemo)((function(){return lo(lo({},r),{},{onNavigateToEntityRecord:u,onNavigateToPreviousEntityRecord:d,defaultRenderingMode:"template-locked",supportsTemplateMode:!0,__experimentalBlockPatterns:_})}),[r,u,d,_]);return!m||"wp_template"!==c.postType&&!f?(0,h.jsx)("div",{className:"spinner-container",children:(0,h.jsx)(D.Spinner,{style:{width:"80px",height:"80px"}})}):(0,h.jsx)(D.SlotFillProvider,{children:(0,h.jsx)(Te.EditorProvider,lo(lo({settings:g,post:m,initialEdits:o,useSubRegistry:!1,__unstableTemplate:f},i),{},{children:(0,h.jsxs)(Te.ErrorBoundary,{children:[(0,h.jsx)(oo,{}),(0,h.jsx)(Te.PostLockedModal,{})]})}))})}const co=window.wp.dataControls,uo=window.wp.apiFetch;var po=n.n(uo);const mo=window.wp.htmlEntities;var fo=hn().mark(Po),_o=hn().mark(Eo),ho=hn().mark(Co);function go(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?go(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):go(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var yo=function(e){return function(t){return t.registry.dispatch(Ue.store).toggle(R,e)}},bo=function(e){return function(t){t.registry.dispatch(Te.store).setDeviceType(e)}};function xo(e){return{type:"CHANGE_PREVIEW_STATE",state:{isModalOpened:e}}}function jo(e){return{type:"CHANGE_PERSONALIZATION_TAGS_STATE",state:vo({isModalOpened:e},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}}function wo(e){return{type:"CHANGE_PREVIEW_STATE",state:{toEmail:e}}}var So=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z;return function(t){return t.registry.dispatch(mt).enableComplementaryArea(R,e)}},ko=function(){return function(e){return e.registry.dispatch(mt).disableComplementaryArea(R)}};function Oo(e){return{type:"TOGGLE_SETTINGS_SIDEBAR_ACTIVE_TAB",state:{activeTab:e}}}function Po(){var e,t;return hn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=(0,a.select)(R).getEmailPostId(),n.next=3,(0,a.dispatch)(Ce.store).saveEditedEntityRecord("postType","mailpoet_email",e,{throwOnError:!0});case 3:(t=n.sent).then((function(){(0,a.dispatch)(In.store).createErrorNotice((0,b.__)("Email saved!","mailpoet"),{type:"snackbar",isDismissible:!0,context:"email-editor"})})),t.catch((function(){(0,a.dispatch)(In.store).createErrorNotice((0,b.__)("The email could not be saved. Please, clear browser cache and reload the page. If the problem persists, duplicate the email and try again.","mailpoet"),{type:"default",isDismissible:!0,context:"email-editor"})}));case 6:case"end":return n.stop()}}),fo)}function Eo(e,t){var n,r,o;return hn().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return n=(0,a.select)(R).getEmailPostId(),r=(0,a.select)(Ce.store).getEditedEntityRecord("postType","mailpoet_email",n),o=(null==r?void 0:r.mailpoet_data)||{},i.next=5,(0,a.dispatch)(Ce.store).editEntityRecord("postType","mailpoet_email",n,{mailpoet_data:vo(vo({},o),{},d({},e,t))});case 5:case"end":return i.stop()}}),_o)}var To=function(e){return function(){var t=mn(hn().mark((function t(n){var r,o;return hn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.registry,o=r.select(R).getEmailPostId(),r.dispatch(Ce.store).editEntityRecord("postType","mailpoet_email",o,{template:e});case 3:case"end":return t.stop()}}),t)})));return function(_x){return t.apply(this,arguments)}}()};function Co(e,t){var n;return hn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(0,a.select)(R).getPreviewState().isSendingPreviewEmail){r.next=3;break}return r.abrupt("return");case 3:return r.next=5,{type:"CHANGE_PREVIEW_STATE",state:{sendingPreviewStatus:null,isSendingPreviewEmail:!0}};case 5:return r.prev=5,n=(0,a.select)(R).getEmailPostId(),r.next=9,(0,co.apiFetch)({path:"/mailpoet-email-editor/v1/send_preview_email",method:"POST",data:{newsletterId:e,email:t,postId:n}});case 9:return r.next=11,{type:"CHANGE_PREVIEW_STATE",state:{sendingPreviewStatus:zn.SUCCESS,isSendingPreviewEmail:!1}};case 11:J("sent_preview_email",{postId:n,email:t}),r.next=19;break;case 14:return r.prev=14,r.t0=r.catch(5),J("sent_preview_email_error",{email:t}),r.next=19,{type:"CHANGE_PREVIEW_STATE",state:{sendingPreviewStatus:zn.ERROR,isSendingPreviewEmail:!1}};case 19:case"end":return r.stop()}}),ho,null,[[5,14]])}function No(e){return function(){var t=mn(hn().mark((function t(n){var r,o,i,a,l,s,c;return hn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.registry,t.prev=1,i=r.select(Ce.store).getEntityConfig("postType",e.type),a=(0,Rn.addQueryArgs)("".concat(i.baseURL,"/").concat(e.id),{context:"edit",source:"theme"}),t.next=6,po()({path:a});case 6:return l=t.sent,s=function(e){var t=e.blocks,n=void 0===t?[]:t;return(0,fe.__unstableSerializeAndClean)(n)},c=(0,fe.parse)(null==l||null===(o=l.content)||void 0===o?void 0:o.raw),t.next=11,r.dispatch(Ce.store).editEntityRecord("postType",e.type,l.id,{content:s,blocks:c,source:"theme"});case 11:return t.next=13,r.dispatch(Ce.store).saveEditedEntityRecord("postType",e.type,e.id,{});case 13:r.dispatch(In.store).createSuccessNotice((0,b.sprintf)(/* translators: The template/part's name. */ /* translators: The template/part's name. */
(0,b.__)('"%s" reset.',"mailpoet"),(0,mo.decodeEntities)(e.title)),{type:"snackbar",id:"edit-site-template-reverted"}),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(1),r.dispatch(In.store).createErrorNotice((0,b.__)("An error occurred while reverting the template.","mailpoet"),{type:"snackbar"});case 19:case"end":return t.stop()}}),t,null,[[1,16]])})));return function(e){return t.apply(this,arguments)}}()}function Io(e){return{type:"SET_IS_FETCHING_PERSONALIZATION_TAGS",state:{isFetching:e}}}function Do(e){return{type:"SET_PERSONALIZATION_TAGS_LIST",state:{list:e}}}function Mo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ao(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mo(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bo(e,t){switch(t.type){case"CHANGE_PREVIEW_STATE":return Ao(Ao({},e),{},{preview:Ao(Ao({},e.preview),t.state)});case"CHANGE_PERSONALIZATION_TAGS_STATE":case"SET_IS_FETCHING_PERSONALIZATION_TAGS":case"SET_PERSONALIZATION_TAGS_LIST":return Ao(Ao({},e),{},{personalizationTags:Ao(Ao({},e.personalizationTags),t.state)});case"TOGGLE_SETTINGS_SIDEBAR_ACTIVE_TAB":return Ao(Ao({},e),{},{settingsSidebar:Ao(Ao({},e.settingsSidebar),{},{activeTab:t.state.activeTab})});case"SET_PERSONALIZATION_TAGS":return Ao(Ao({},e),{},{personalizationTags:Ao(Ao({},e.personalizationTags),{},{list:t.personalizationTags})});default:return e}}function Lo(e){return null!=e&&e.content&&"function"==typeof e.content?e.content(e):null!=e&&e.blocks?(0,fe.serialize)(e.blocks):null!=e&&e.content?e.content:""}var Ro=(0,a.createRegistrySelector)((function(e){return function(t,n){return!!e(Ue.store).get(R,n)}})),zo=(0,a.createRegistrySelector)((function(e){return function(){return!!e(mt).getActiveComplementaryArea(R)}})),Fo=(0,a.createRegistrySelector)((function(e){return function(){var t=e(R).getEmailPostId();return!!e(Ce.store).hasEditsForEntityRecord("postType","mailpoet_email",t)}})),Vo=(0,a.createRegistrySelector)((function(e){return function(){var t=e(R).getEmailPostId();return!!e(Ce.store).getEntityRecord("postType","mailpoet_email",t)}})),Ho=(0,a.createRegistrySelector)((function(e){return function(){var t=e(R).getEmailPostId();return!!e(Ce.store).isSavingEntityRecord("postType","mailpoet_email",t)}})),Go=(0,a.createRegistrySelector)((function(e){return function(){var t=e(R).getEmailPostId(),n=e(Ce.store).getEntityRecord("postType","mailpoet_email",t);if(!n)return!0;var r=n.content,o=n.mailpoet_data,i=n.title;return!(r.raw||o.subject||o.preheader||i.raw)}})),Uo=(0,a.createRegistrySelector)((function(e){return function(){var t=e(R).getEmailPostId(),n=e(Ce.store).getEntityRecord("postType","mailpoet_email",t);return!n||!n.content.raw}})),Wo=(0,a.createRegistrySelector)((function(e){return function(){var t=e(R).getEmailPostId(),n=e(Ce.store).getEntityRecord("postType","mailpoet_email",t);return!!n&&"sent"===n.status}})),$o=(0,a.createRegistrySelector)((function(e){return function(){var t=e(R).getEmailPostId(),n=e(Ce.store).getEditedEntityRecord("postType","mailpoet_email",t);return n?Lo(n):""}})),qo=(0,a.createRegistrySelector)((function(e){return function(){var t;return(null===(t=e(Ce.store).getEntityRecords("postType","mailpoet_email",{per_page:30,status:"publish,sent"}))||void 0===t?void 0:t.filter((function(e){var t;return""!==(null==e||null===(t=e.content)||void 0===t?void 0:t.raw)})))||[]}})),Zo=(0,a.createRegistrySelector)((function(e){return function(){var t=e(Te.store).getEditedPostAttribute("template");if(t){var n,r=null===(n=e(Ce.store).getEntityRecords("postType","wp_template",{per_page:-1}))||void 0===n?void 0:n.find((function(e){return e.slug===t}));return r?e(Ce.store).getEditedEntityRecord("postType","wp_template",r.id):r}var o=e(Ce.store).getDefaultTemplateId({slug:"email-general"});return e(Ce.store).getEditedEntityRecord("postType","wp_template",o)}})),Yo=(0,a.createRegistrySelector)((function(e){return function(){if("wp_template"===e(Te.store).getCurrentPostType()){var t=e(Te.store).getCurrentPostId();return e(Ce.store).getEditedEntityRecord("postType","wp_template",t)}return Zo()}})),Jo=function(){var e=Yo();return e?Lo(e):""},Ko=(0,a.createRegistrySelector)((function(e){return function(){var t=e(R).getGlobalStylesPostId();return t?e(Ce.store).getEditedEntityRecord("postType","wp_global_styles",t):Zo()}})),Xo=(0,a.createRegistrySelector)((function(e){return function(){var t;return null===(t=e(Ce.store).getEntityRecords("postType","wp_template",{per_page:-1,post_type:"mailpoet_email"}))||void 0===t?void 0:t.filter((function(e){return e.post_types.includes("mailpoet_email")}))}}));function Qo(e){return e.postId}function ei(e){return e.settingsSidebar.activeTab}function ti(e){return e.editorSettings}function ni(e){return e.editorSettings.__experimentalFeatures.color.palette}function ri(e){return e.preview}function oi(e){return e.personalizationTags}function ii(e){return e.personalizationTags.list}var ai=(0,a.createRegistrySelector)((function(e){return function(){return e(Te.store).getDeviceType()}}));function li(e){return e.theme.styles}function si(e){return e.autosaveInterval}function ci(e){return e.cdnUrl}function ui(e){return e.isPremiumPluginActive}function di(e){return e.theme}function pi(e){return e.styles.globalStylesPostId}function mi(e){return e.urls}var fi=hn().mark(_i);function _i(){var e,t,n;return hn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,a.select)(R);case 2:if(t=r.sent,!(null===(e=t.personalizationTags)||void 0===e?void 0:e.isFetching)){r.next=6;break}return r.abrupt("return");case 6:return r.next=8,Io(!0);case 8:return r.prev=8,r.next=11,(0,co.apiFetch)({path:"/mailpoet-email-editor/v1/get_personalization_tags",method:"GET"});case 11:return n=r.sent,r.next=14,Do(n.result);case 14:return r.prev=14,r.next=17,Io(!1);case 17:return r.finish(14);case 18:case"end":return r.stop()}}),fi,null,[[8,,14,18]])}const hi=window.wp.keyboardShortcuts;function gi(){var e=(0,a.useDispatch)(Ce.store),t=e.undo,n=e.redo,r=(0,a.useSelect)((function(e){return{isSidebarOpened:e(R).isSidebarOpened(),isSaving:e(R).isSaving(),hasEdits:e(R).hasEdits()}})),o=r.isSidebarOpened,i=r.hasEdits,s=r.isSaving,c=(0,a.useDispatch)(R),u=c.openSidebar,d=c.closeSidebar,p=c.saveEditedEmail,m=c.toggleFeature,f=(0,a.useDispatch)(hi.store).registerShortcut;return(0,l.useEffect)((function(){f({name:"mailpoet/email-editor/toggle-fullscreen",category:"global",description:(0,b.__)("Toggle fullscreen mode.","mailpoet"),keyCombination:{modifier:"secondary",character:"f"}}),f({name:"mailpoet/email-editor/toggle-sidebar",category:"global",description:(0,b.__)("Show or hide the settings sidebar.","mailpoet"),keyCombination:{modifier:"primaryShift",character:","}}),f({name:"mailpoet/email-editor/save",category:"global",description:(0,b.__)("Save your changes.","mailpoet"),keyCombination:{modifier:"primary",character:"s"}}),f({name:"mailpoet/email-editor/undo",category:"block",description:(0,b.__)("Undo your last changes."),keyCombination:{modifier:"primary",character:"z"}}),f({name:"mailpoet/email-editor/redo",category:"block",description:(0,b.__)("Redo your last undo."),keyCombination:{modifier:"primaryShift",character:"z"}})}),[f]),(0,hi.useShortcut)("mailpoet/email-editor/toggle-fullscreen",(function(){J("keyboard_shortcuts_toggle_fullscreen"),m("fullscreenMode")})),(0,hi.useShortcut)("mailpoet/email-editor/toggle-sidebar",(function(e){J("keyboard_shortcuts_toggle_sidebar"),e.preventDefault(),o?d():u()})),(0,hi.useShortcut)("mailpoet/email-editor/save",(function(e){J("keyboard_shortcuts_save"),e.preventDefault(),i&&!s&&p()})),(0,hi.useShortcut)("mailpoet/email-editor/undo",(function(e){t(),e.preventDefault()})),(0,hi.useShortcut)("mailpoet/email-editor/redo",(function(e){n(),e.preventDefault()})),null}var vi=function(e){(0,s.doAction)("mailpoet_email_editor_events",e.detail)};window.addEventListener("unload",(function(){q&&Y.removeEventListener(Z,vi)}));var yi=(0,s.applyFilters)("mailpoet_email_editor_wrap_editor_component",(function(){var e=(0,a.useSelect)((function(e){return{postId:e(R).getEmailPostId(),settings:e(R).getInitialEditorSettings()}}),[]),t=e.postId,n=e.settings;return(0,h.jsxs)(l.StrictMode,{children:[(0,h.jsx)(gi,{}),(0,h.jsx)(so,{initialEdits:[],postId:t,postType:"mailpoet_email",settings:n})]})}));function bi(e){var t=document.getElementById(e);t&&(q&&Y.addEventListener(Z,vi),function(){var e,t,n=(0,a.createReduxStore)(R,{actions:r,controls:co.controls,selectors:o,resolvers:i,reducer:Bo,initialState:(e=new URLSearchParams(window.location.search),t=parseInt(e.get("post"),10),{inserterSidebar:{isOpened:!1},listviewSidebar:{isOpened:!1},settingsSidebar:{activeTab:z},postId:t,editorSettings:window.MailPoetEmailEditor.editor_settings,theme:window.MailPoetEmailEditor.editor_theme,styles:{globalStylesPostId:window.MailPoetEmailEditor.user_theme_post_id},autosaveInterval:60,cdnUrl:window.MailPoetEmailEditor.cdn_url,isPremiumPluginActive:window.MailPoetEmailEditor.is_premium_plugin_active,urls:window.MailPoetEmailEditor.urls,preview:{deviceType:"Desktop",toEmail:window.MailPoetEmailEditor.current_wp_user_email,isModalOpened:!1,isSendingPreviewEmail:!1,sendingPreviewStatus:null},personalizationTags:{list:[],isFetching:!1}})});(0,a.register)(n)}(),(0,s.addFilter)("blocks.registerBlockType","mailpoet-email-editor/layout/addAttribute",ke),(0,s.addFilter)("editor.BlockListBlock","mailpoet-email-editor/with-layout-styles",Ee),(0,s.addFilter)("editor.BlockEdit","mailpoet-email-editor/with-inspector-controls",Oe),(0,s.addFilter)("editor.BlockEdit","mailpoet-email-editor/deactivate-stack-on-mobile",y),(0,s.addFilter)("editor.BlockEdit","mailpoet-email-editor/hide-expand-on-click",E),(0,s.addFilter)("blocks.registerBlockType","mailpoet-email-editor/deactivate-image-filter",(function(e,t){return"core/image"===t?P(P({},e),{},{supports:P(P({},e.supports),{},{filter:{duetone:!1}})}):e})),(0,I.unregisterFormatType)("core/image"),(0,I.unregisterFormatType)("core/code"),(0,I.unregisterFormatType)("core/language"),(0,s.addFilter)("blocks.registerBlockType","mailpoet-email-editor/disable-columns-layout",(function(e,t){return"core/columns"===t||"core/column"===t?v(v({},e),{},{supports:v(v({},e.supports),{},{layout:!1})}):e})),(0,s.addFilter)("blocks.registerBlockType","mailpoet-email-editor/disable-group-variations",(function(e,t){return"core/group"===t?k(k({},e),{},{variations:e.variations.filter((function(e){return"group"===e.name})),supports:k(k({},e.supports),{},{layout:!1})}):e})),(0,s.addFilter)("blocks.registerBlockType","mailpoet-email-editor/change-button",(function(e,t){return"core/button"===t?le(le({},e),{},{styles:[]}):e})),(0,s.addFilter)("blocks.registerBlockType","mailpoet-email-editor/change-buttons",(function(e,t){return"core/buttons"===t?ce(ce({},e),{},{supports:ce(ce({},e.supports),{},{layout:!1,__experimentalEmailFlexLayout:!0})}):e})),(0,s.addFilter)("blocks.registerBlockType","mailpoet-email-editor/change-column",(function(e,t){return"core/column"===t?m(m({},e),{},{supports:m(m({},e.supports),{},{background:{backgroundImage:!0}})}):e})),(0,s.addFilter)("blocks.registerBlockType","mailpoet-email-editor/change-columns",(function(e,t){return"core/columns"===t?v(v({},e),{},{supports:v(v({},e.supports),{},{background:{backgroundImage:!0}})}):e})),(0,s.addFilter)("blocks.registerBlockType","mailpoet-email-editor/change-post-content",(function(e,t){return"core/post-content"===t?j(j({},e),{},{edit:(n=e.edit,function(e){var t=e.context,r=e.__unstableLayoutClassNames,o=t.postId,i=t.postType;return o&&i?(0,h.jsx)(n,{context:t,__unstableLayoutClassNames:r}):(0,h.jsx)(w,{layoutClassNames:r})})}):e;var n})),(0,I.registerFormatType)("mailpoet-email-editor/shortcode",{name:"mailpoet-email-editor/shortcode",title:(0,b.__)("Personalization Tags","mailpoet"),className:"mailpoet-email-editor-personalization-tags",tagName:"span",attributes:{},edit:oe}),(0,I.registerFormatType)("mailpoet-email-editor/link-shortcode",{name:"mailpoet-email-editor/link-shortcode",title:(0,b.__)("Personalization Tags Link","mailpoet"),className:"mailpoet-email-editor__personalization-tags-link",tagName:"a",attributes:{"data-link-href":"data-link-href",contenteditable:"contenteditable",style:"style"},edit:null}),(0,s.addFilter)("editor.BlockEdit","mailpoet-email-editor/with-live-content-update",ie),(0,s.addFilter)("blocks.registerBlockType","mailpoet-email-editor/block-support",(function(e){var t;return null!==(t=e.supports)&&void 0!==t&&t.shadow?de(de({},e),{},{supports:de(de({},e.supports),{},{shadow:!1})}):e})),(0,c.registerCoreBlocks)(),(0,s.addFilter)("editor.MediaUpload","mailpoet/email-editor/replace-media-upload",(function(){return Le.MediaUpload})),(0,l.createRoot)(t).render((0,h.jsx)(yi,{})))}window.addEventListener("DOMContentLoaded",(function(){bi("mailpoet-email-editor")}))})()})();